
<!-- This adds support for mkdocs-git-authors-plugin to mkdocs-material theme -->

<!doctype html>
<html lang="en" class="no-js">
  <head>

      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">



        <link rel="canonical" href="https://pypi.org/project/pear-ebi/0.1.1.10/print_page.html">



      <link rel="icon" href="https://github.com/AndreaRubbi/Pear-EBI/raw/pear_ebi/logos/LOGO_PEAR.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.13">



        <title>Print Site - PEAR-EBI</title>



      <link rel="stylesheet" href="assets/stylesheets/main.ffa9267a.min.css">


        <link rel="stylesheet" href="assets/stylesheets/palette.a0c5b2b5.min.css">









        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>



      <link rel="stylesheet" href="css/print-site-enum-headings1.css">

      <link rel="stylesheet" href="css/print-site-enum-headings2.css">

      <link rel="stylesheet" href="css/print-site-enum-headings3.css">

      <link rel="stylesheet" href="css/print-site-enum-headings4.css">

      <link rel="stylesheet" href="css/print-site-enum-headings5.css">

      <link rel="stylesheet" href="css/print-site-enum-headings6.css">

      <link rel="stylesheet" href="css/print-site.css">

      <link rel="stylesheet" href="css/print-site-material.css">

      <link rel="stylesheet" href="css/timeago.css">

      <link rel="stylesheet" href="assets/_mkdocstrings.css">

      <link rel="stylesheet" href="docs_assets/stylesheets/pdf-export.css">

      <link rel="stylesheet" href="css/ansi-colours.css">

      <link rel="stylesheet" href="css/pandas-dataframe.css">

    <script>__md_scope=new URL("/project/pear-ebi/0.1.1.10/",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>







        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>







    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="green" data-md-color-accent="indigo">



    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">


        <a href="#" class="md-skip">
          Skip to content
        </a>

    </div>
    <div data-md-component="announce">

    </div>




<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="PEAR-EBI" class="md-header__button md-logo" aria-label="PEAR-EBI" data-md-component="logo">


  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PEAR-EBI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">

              Print Site

          </span>
        </div>
      </div>
    </div>



      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">

        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>

    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>


      <div class="md-header__source">
        <a href="https://github.com/AndreaRubbi/Pear-EBI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">

    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    PEAR-EBI
  </div>
</a>
      </div>

  </nav>

</header>

    <div class="md-container" data-md-component="container">






      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">



              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="PEAR-EBI" class="md-nav__button md-logo" aria-label="PEAR-EBI" data-md-component="logo">


  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg>

    </a>
    PEAR-EBI
  </label>

    <div class="md-nav__source">
      <a href="https://github.com/AndreaRubbi/Pear-EBI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">

    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    PEAR-EBI
  </div>
</a>
    </div>

  <ul class="md-nav__list" data-md-scrollfix>








    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Home
      </a>
    </li>











    <li class="md-nav__item md-nav__item--nested">




      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >



        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Modules
          <span class="md-nav__icon md-icon"></span>
        </label>

      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>






    <li class="md-nav__item">
      <a href="modules/gendoc.html" class="md-nav__link">
        Gendoc
      </a>
    </li>










    <li class="md-nav__item md-nav__item--nested">




      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >



        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          Pear ebi
          <span class="md-nav__icon md-icon"></span>
        </label>

      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Pear ebi
        </label>
        <ul class="md-nav__list" data-md-scrollfix>






    <li class="md-nav__item">
      <a href="modules/pear_ebi/tree_emb_parser.html" class="md-nav__link">
        Tree emb parser
      </a>
    </li>









    <li class="md-nav__item">
      <a href="modules/pear_ebi/tree_set.html" class="md-nav__link">
        Tree set
      </a>
    </li>










    <li class="md-nav__item md-nav__item--nested">




      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >



        <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
          Calculate distances
          <span class="md-nav__icon md-icon"></span>
        </label>

      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2_3">
          <span class="md-nav__icon md-icon"></span>
          Calculate distances
        </label>
        <ul class="md-nav__list" data-md-scrollfix>






    <li class="md-nav__item">
      <a href="modules/pear_ebi/calculate_distances/hashrf.html" class="md-nav__link">
        Hashrf
      </a>
    </li>









    <li class="md-nav__item">
      <a href="modules/pear_ebi/calculate_distances/maple_RF.html" class="md-nav__link">
        maple RF
      </a>
    </li>









    <li class="md-nav__item">
      <a href="modules/pear_ebi/calculate_distances/tqdist.html" class="md-nav__link">
        Tqdist
      </a>
    </li>




        </ul>
      </nav>
    </li>










    <li class="md-nav__item md-nav__item--nested">




      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4" >



        <label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
          Embeddings
          <span class="md-nav__icon md-icon"></span>
        </label>

      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2_4">
          <span class="md-nav__icon md-icon"></span>
          Embeddings
        </label>
        <ul class="md-nav__list" data-md-scrollfix>






    <li class="md-nav__item">
      <a href="modules/pear_ebi/embeddings/Isomap_e.html" class="md-nav__link">
        Isomap e
      </a>
    </li>









    <li class="md-nav__item">
      <a href="modules/pear_ebi/embeddings/LLE_e.html" class="md-nav__link">
        LLE e
      </a>
    </li>









    <li class="md-nav__item">
      <a href="modules/pear_ebi/embeddings/PCoA_e.html" class="md-nav__link">
        PCoA e
      </a>
    </li>









    <li class="md-nav__item">
      <a href="modules/pear_ebi/embeddings/emb_quality.html" class="md-nav__link">
        Emb quality
      </a>
    </li>









    <li class="md-nav__item">
      <a href="modules/pear_ebi/embeddings/tSNE_e.html" class="md-nav__link">
        tSNE e
      </a>
    </li>










    <li class="md-nav__item md-nav__item--nested">




      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_6" >



        <label class="md-nav__link" for="__nav_2_2_4_6" id="__nav_2_2_4_6_label" tabindex="0">
          Graph
          <span class="md-nav__icon md-icon"></span>
        </label>

      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2_4_6">
          <span class="md-nav__icon md-icon"></span>
          Graph
        </label>
        <ul class="md-nav__list" data-md-scrollfix>






    <li class="md-nav__item">
      <a href="modules/pear_ebi/embeddings/graph/graph.html" class="md-nav__link">
        Graph
      </a>
    </li>




        </ul>
      </nav>
    </li>




        </ul>
      </nav>
    </li>










    <li class="md-nav__item md-nav__item--nested">




      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_5" >



        <label class="md-nav__link" for="__nav_2_2_5" id="__nav_2_2_5_label" tabindex="0">
          Interactive mode
          <span class="md-nav__icon md-icon"></span>
        </label>

      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2_5">
          <span class="md-nav__icon md-icon"></span>
          Interactive mode
        </label>
        <ul class="md-nav__list" data-md-scrollfix>






    <li class="md-nav__item">
      <a href="modules/pear_ebi/interactive_mode/interactive.html" class="md-nav__link">
        Interactive
      </a>
    </li>




        </ul>
      </nav>
    </li>










    <li class="md-nav__item md-nav__item--nested">




      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_6" >



        <label class="md-nav__link" for="__nav_2_2_6" id="__nav_2_2_6_label" tabindex="0">
          Subsample
          <span class="md-nav__icon md-icon"></span>
        </label>

      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2_6">
          <span class="md-nav__icon md-icon"></span>
          Subsample
        </label>
        <ul class="md-nav__list" data-md-scrollfix>






    <li class="md-nav__item">
      <a href="modules/pear_ebi/subsample/subsample.html" class="md-nav__link">
        Subsample
      </a>
    </li>









    <li class="md-nav__item">
      <a href="modules/pear_ebi/subsample/subsample_multiprocess.html" class="md-nav__link">
        Subsample multiprocess
      </a>
    </li>




        </ul>
      </nav>
    </li>




        </ul>
      </nav>
    </li>










    <li class="md-nav__item md-nav__item--nested">




      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >



        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          Test
          <span class="md-nav__icon md-icon"></span>
        </label>

      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Test
        </label>
        <ul class="md-nav__list" data-md-scrollfix>






    <li class="md-nav__item">
      <a href="modules/test/test.html" class="md-nav__link">
        Test
      </a>
    </li>




        </ul>
      </nav>
    </li>




        </ul>
      </nav>
    </li>











    <li class="md-nav__item md-nav__item--nested">




      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >



        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>

      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>






    <li class="md-nav__item">
      <a href="tutorials/1How_to_use_pear_ebi.html" class="md-nav__link">
        1. How to use Pear
      </a>
    </li>









    <li class="md-nav__item">
      <a href="tutorials/2Advanced%20use%20of%20pear_ebi.html" class="md-nav__link">
        2. Advanced uses of Pear
      </a>
    </li>









    <li class="md-nav__item">
      <a href="tutorials/3How%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper.html" class="md-nav__link">
        3. How to use Pear on python
      </a>
    </li>




        </ul>
      </nav>
    </li>



  </ul>
</nav>
                  </div>
                </div>
              </div>



              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">




    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>

        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    1. Home
  </a>

</li>

        <li class="md-nav__item">
  <a href="#section-modules" class="md-nav__link">
    I. Modules
  </a>

    <nav class="md-nav" aria-label="I. Modules">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#modules-gendoc" class="md-nav__link">
    2. Gendoc
  </a>

</li>

      </ul>
    </nav>

</li>

        <li class="md-nav__item">
  <a href="#section-tutorials" class="md-nav__link">
    II. Tutorials
  </a>

    <nav class="md-nav" aria-label="II. Tutorials">
      <ul class="md-nav__list">

          <li class="md-nav__item">
  <a href="#tutorials-1how_to_use_pear_ebi" class="md-nav__link">
    3. 1. How to use Pear
  </a>

</li>

          <li class="md-nav__item">
  <a href="#tutorials-2advanced%20use%20of%20pear_ebi" class="md-nav__link">
    4. 2. Advanced uses of Pear
  </a>

</li>

          <li class="md-nav__item">
  <a href="#tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper" class="md-nav__link">
    5. 3. How to use Pear on python
  </a>

</li>

      </ul>
    </nav>

</li>

    </ul>

</nav>
                  </div>
                </div>
              </div>



            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">




<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1> Phylogeny Embedding  & <br>  Approximate Representation </h1>
<p><img src="https://github.com/AndreaRubbi/Pear-EBI/raw/pear_ebi/logos/LOGO_PEAR.png" width="100" height="100" style='position:absolute; left:900px; top:75px' ></p>
<p><img src="https://img.shields.io/github/license/AndreaRubbi/Pear-EBI?color=red&label=License&style=plastic"> <img src="https://img.shields.io/pypi/v/pear_ebi?color=purple&label=version&style=plastic"> <img src="https://img.shields.io/pypi/implementation/pear_ebi?style=plastic"> <img src="https://img.shields.io/pypi/pyversions/pear_ebi?color=green&style=plastic"></p>
<h2 id="index-goldman-group-european-bioinformatics-institute">Goldman Group - European Bioinformatics Institute <img src="https://github.com/AndreaRubbi/Pear-EBI/raw/pear_ebi/logos/goldman_logo.png" width="30" height="30"><a class="headerlink" href="#index-goldman-group-european-bioinformatics-institute" title="Permanent link">&para;</a></h2>
<p>PEAR can:
1. Compute the distance matrix given a set of phylogenetic trees;
2. Embed and represent the distance matrix in 2D or 3D.</p>
<p>See also the <a href="https://andrearubbi.github.io/Pear-EBI/index.html"> autogenerated documentation </a> and <a href="https://pypi.org/project/pear-ebi/"> PyPI </a>.</p>
<h1 id="index-pear-usage">PEAR usage<a class="headerlink" href="#index-pear-usage" title="Permanent link">&para;</a></h1>
<p>Pear is both a python software and library. It can be installed with <code>python -m pip install pear_ebi</code> or downloaded from <a href="https://github.com/AndreaRubbi/Pear-EBI">Github</a>. Pear is currently compatible only with Linux.</p>
<h2 id="index-pear-as-a-python-library">PEAR as a python library<a class="headerlink" href="#index-pear-as-a-python-library" title="Permanent link">&para;</a></h2>
<p>Once installed, Pear can be used to upload newick trees in python and represent them in embedded spaces. We recommend to use it on either jupyter notebook or lab, as these tools allow for more interaction with the graphs. On these platforms, the user is allowed to interact with widgets that allows to modify several parameteres of the plots. For specific uses and applications, see the <a href='https://github.com/AndreaRubbi/Pear-EBI/tree/pear_ebi/examples_tree_sets'>examples</a>.</p>
<h2 id="index-pear-as-a-program">PEAR as a program<a class="headerlink" href="#index-pear-as-a-program" title="Permanent link">&para;</a></h2>
<p>Run <code>pear_ebi --help</code> to see the complete list of arguments and flags.</p>
<h3 id="index-simple-usage">Simple usage<a class="headerlink" href="#index-simple-usage" title="Permanent link">&para;</a></h3>
<p><code>pear_ebi examples_tree_sets/beast_trees/beast_run1.trees -m hashrf_RF</code></p>
<p>this script calculates the unweighted <a href='https://doi.org/10.1016/0025-5564(81)90043-2'>Robison Foulds</a> distances between the trees in the file "beast_run1.trees", which contains 1001 phylogenetic trees.</p>
<p>the flag <em>-m</em> indicates the method used to compute the dissimilarity between phylogeneic trees. In this case, <a href="https://code.google.com/archive/p/hashrf/">HasRF</a> has been used.</p>
<p>To embed these distances in a lower-dimensional space, we can use PCoA (MDS) or tSNE:</p>
<p><code>pear_ebi examples_tree_sets/beast_trees/beast_run1.trees -m hashrf_RF --pcoa 2</code></p>
<p>we therefore embedded the distance matrix in 2 dimensions. Using the flag <em>-quality</em> one can assess the correlation between the distances in the N-dimensional space and in the embedding.</p>
<p><code>pear_ebi examples_tree_sets/beast_trees/beast_run1.trees -m hashrf_RF --pcoa 2 --plot</code></p>
<p>The flag <em>-plot</em> indicates that PEAR has to plot the embeddings and show them, respectively. If an embedding method is specified the plots are produced anyway. Plotting doesn't require any indication on the number of dimensions as the embeddings are represented in 2 dimensions if the distances are embedded in 2 dimensions, while it plots on 2 and 3 dimensions in any other case.</p>
<p>One can specify any number of files containing trees. Moreover, it is possible to specify a single directory using <em>-dir</em>, and possibly a pattern using <em>-pattern</em>, in order to select multiple files.</p>
<h4 id="index-tree-set">Tree Set<a class="headerlink" href="#index-tree-set" title="Permanent link">&para;</a></h4>
<p>It's possible to compute the distance matrix and re-use it in subsequent runs of PEAR by specifying the distance matrix file with the flag <em>-d</em>. Additionally, it's possible to define the name of the output file (<em>-o</em>).</p>
<p>If any additional metadata is available, this may be specified by indicating a <em>.csv</em> file containing a dataframe of compatible shape.</p>
<h3 id="index-config-file">Config file<a class="headerlink" href="#index-config-file" title="Permanent link">&para;</a></h3>
<p>A standard config toml file can be used for specific emebddings of multiple sets of trees. Instances of toml files are reported in the <a href='https://github.com/AndreaRubbi/Pear-EBI/tree/pear_ebi/examples_tree_sets'>examples</a> folder.</p>
<p>Using the config file allows one to use all the features of PEAR, including additional embedding methods and plot designs. The config file can also be used to specify lists of indexes of interesting trees in the sets, in order to highlight them in the final plots.</p>
<h3 id="index-interactive-mode">Interactive mode<a class="headerlink" href="#index-interactive-mode" title="Permanent link">&para;</a></h3>
<p><code>pear_ebi -i</code> :
this script launches the program in the interactive mode. Once the program starts, it is going to guide you through its usage thanks to an intuitive interface.</p>
<h2 id="index-turorials-and-examples">Turorials and Examples<a class="headerlink" href="#index-turorials-and-examples" title="Permanent link">&para;</a></h2>
<p>Follow <a href='https://github.com/AndreaRubbi/Pear-EBI/tree/pear_ebi/examples_tree_sets'>this link</a> for a complete set of basic and avanced guides and tutorials to use PEAR on the command line and as a python library.</p>
<!--- ### Additional Dependencies
 In order to get the complete report on the quality of embeddings, it may be necessary to
 run the following command to install additional dependencies:

 `sudo apt-get install '^libxcb.*-dev' libx11-xcb-dev libglu1-mesa-dev libxrender-dev libxi-dev libxkbcommon-dev libxkbcommon-x11-dev`

 It may be necessary to also install `libgcc` and remove old versions of `libstdc++` from the interpreter libraries. --->
<hr />
<h2 id="index-licensing">Licensing<a class="headerlink" href="#index-licensing" title="Permanent link">&para;</a></h2>
<p>This project is released under the terms of the MIT Open Source License. View
<em>LICENSE.txt</em> for more information.</p></section>
                        <h1 class='nav-section-title' id='section-modules'>
                            Modules <a class='headerlink' href='#section-modules' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="modules-gendoc"><h1 id="modules-gendoc-_1"><a class="headerlink" href="#modules-gendoc-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-gendoc-add_val">add_val<a class="headerlink" href="#modules-gendoc-add_val" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/gendoc.py/#L14">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">add_val</span><span class="p">(</span>
   <span class="n">indices</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">data</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<h3 id="modules-gendoc-automate_mkdocs_from_docstring">automate_mkdocs_from_docstring<a class="headerlink" href="#modules-gendoc-automate_mkdocs_from_docstring" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/gendoc.py/#L23">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">automate_mkdocs_from_docstring</span><span class="p">(</span>
   <span class="n">mkdocs_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">mkgendocs_f</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">repo_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
   <span class="n">match_string</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Automates the -pages for mkgendocs package by adding all Python functions in a directory to the mkgendocs config.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>mkdocs_dir</strong> (typing.Union[str, pathlib.Path]) : textual directory for the hierarchical directory &amp; navigation in Mkdocs</li>
<li><strong>mkgendocs_f</strong> (str) : The configurations file for the mkgendocs package</li>
<li><strong>repo_dir</strong> (pathlib.Path) : textual directory to search for Python functions in</li>
<li><strong>match_string</strong> (str) : the text to be matches, after which the functions will be added in mkgendocs format</li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">automate_mkdocs_from_docstring</span><span class="p">(</span><span class="s1">&#39;scripts&#39;</span><span class="p">,</span> <span class="n">repo_dir</span><span class="o">=</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">(),</span> <span class="n">match_string</span><span class="o">=</span><span class="s1">&#39;pages:&#39;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Returns</strong></p>
<ul>
<li><strong>list</strong>  : list of created markdown files and their relative paths</li>
</ul>
<hr />
<h3 id="modules-gendoc-automate_nav_structure">automate_nav_structure<a class="headerlink" href="#modules-gendoc-automate_nav_structure" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/gendoc.py/#L124">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">automate_nav_structure</span><span class="p">(</span>
   <span class="n">mkdocs_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">mkdocs_f</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">repo_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">match_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
   <span class="n">structure</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Automates the -pages for mkgendocs package by adding all Python functions in a directory to the mkgendocs config.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>mkdocs_dir</strong> (typing.Union[str, pathlib.Path]) : textual directory for the hierarchical directory &amp; navigation in Mkdocs</li>
<li><strong>mkgendocs_f</strong> (str) : The configurations file for the mkgendocs package</li>
<li><strong>repo_dir</strong> (pathlib.Path) : textual directory to search for Python functions in</li>
<li><strong>match_string</strong> (str) : the text to be matches, after which the functions will be added in mkgendocs format</li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">automate_mkdocs_from_docstring</span><span class="p">(</span><span class="s1">&#39;scripts&#39;</span><span class="p">,</span> <span class="n">repo_dir</span><span class="o">=</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">(),</span> <span class="n">match_string</span><span class="o">=</span><span class="s1">&#39;pages:&#39;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Returns</strong></p>
<ul>
<li><strong>str</strong>  : feedback message</li>
</ul>
<hr />
<h3 id="modules-gendoc-fix">fix<a class="headerlink" href="#modules-gendoc-fix" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/gendoc.py/#L163">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">fix</span><span class="p">(</span>
   <span class="n">f</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Allows creation of arbitrary length dict item</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>f</strong> (type) : Description of parameter <code>f</code>.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>type</strong>  : Description of returned object.</li>
</ul>
<hr />
<h3 id="modules-gendoc-indent">indent<a class="headerlink" href="#modules-gendoc-indent" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/gendoc.py/#L176">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">indent</span><span class="p">(</span>
   <span class="n">string</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Count the indentation in whitespace characters.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>string</strong> (str) : text with indents</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>int</strong>  : Number of whitespace indentations</li>
</ul></section>
                        <h2 class='nav-section-title' id='section-pear-ebi'>
                            Pear ebi <a class='headerlink' href='#section-pear-ebi' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="modules-pear_ebi-tree_emb_parser"><h1 id="modules-pear_ebi-tree_emb_parser-_1"><a class="headerlink" href="#modules-pear_ebi-tree_emb_parser-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-tree_emb_parser-parser">parser<a class="headerlink" href="#modules-pear_ebi-tree_emb_parser-parser" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/tree_emb_parser.py/#L6">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">parser</span><span class="p">()</span>
</code></pre></div></p>
<hr />
<p>Generates parser for PEAR program</p>
<p><strong>Returns</strong></p>
<ul>
<li><strong>parser</strong>  : PEAR parser</li>
</ul></section><section class="print-page" id="modules-pear_ebi-tree_set"><h1 id="modules-pear_ebi-tree_set-_1"><a class="headerlink" href="#modules-pear_ebi-tree_set-_1" title="Permanent link">&para;</a></h1>
<h2 id="modules-pear_ebi-tree_set-tree_set">tree_set<a class="headerlink" href="#modules-pear_ebi-tree_set-tree_set" title="Permanent link">&para;</a></h2>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/tree_set.py/#L75">source</a>
<div class="highlight"><pre><span></span><code><span class="n">tree_set</span><span class="p">(</span>
   <span class="n">file</span><span class="p">,</span> <span class="n">output_file</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">distance_matrix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Class for the analysis of a set of phylogenetic trees</p>
<p><strong>Methods:</strong></p>
<h3 id="modules-pear_ebi-tree_set-calculate_distances">.calculate_distances<a class="headerlink" href="#modules-pear_ebi-tree_set-calculate_distances" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/tree_set.py/#L162">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">calculate_distances</span><span class="p">(</span>
   <span class="n">method</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Computes tree_set distance matrix with method of choice</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>method</strong> (str) : method/algorithm used to compute distance matrix</li>
</ul>
<h3 id="modules-pear_ebi-tree_set-embed">.embed<a class="headerlink" href="#modules-pear_ebi-tree_set-embed" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/tree_set.py/#L184">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">embed</span><span class="p">(</span>
   <span class="n">method</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">,</span> <span class="n">quality</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">report</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Compute embedding with n-dimensions and method of choice</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>method</strong> (str) : method of choice to embed data</li>
<li><strong>dimensions</strong> (<em>type</em>) : number of dimensions/components</li>
<li><strong>quality</strong> (bool, optional) : returns quality report and self.emb_quality. Defaults to False.</li>
</ul>
<h3 id="modules-pear_ebi-tree_set-plot_2d">.plot_2D<a class="headerlink" href="#modules-pear_ebi-tree_set-plot_2d" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/tree_set.py/#L284">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">plot_2D</span><span class="p">(</span>
   <span class="n">method</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name_plot</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">static</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">plot_meta</span> <span class="o">=</span> <span class="s1">&#39;SET-ID&#39;</span><span class="p">,</span>
   <span class="n">plot_set</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">select</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">same_scale</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Plot 2D embedding performed with method of choice</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>method</strong> (str) : embedding method</li>
<li><strong>save</strong> (bool, optional) : save plot HTML. Defaults to False.</li>
<li><strong>name_plot</strong> (str, optional) : name of plot's file. Defaults to None.</li>
<li><strong>static</strong> (bool, optional) : return less interactive plot. Defaults to False.</li>
<li><strong>plot_meta</strong> (str, optional) : meta-variale used to color the points. Defaults to "SET-ID".</li>
<li><strong>plot_set</strong> (list, optional) : list of sets to plot from set_collection. Defaults to None.</li>
<li><strong>select</strong> (bool, optional) : return set of buttons to show or hide specific traces. Defaults to False.</li>
<li><strong>same_scale</strong> (bool, optional) : use same color_scale for all traces when scale is continuous. Defaults to False.</li>
</ul>
<p><strong>Raises</strong></p>
<ul>
<li><strong>ValueError</strong>  : method can only be either pcoa or tsne for now</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>plot</strong>  : either interactive or not</li>
</ul>
<h3 id="modules-pear_ebi-tree_set-plot_3d">.plot_3D<a class="headerlink" href="#modules-pear_ebi-tree_set-plot_3d" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/tree_set.py/#L394">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">plot_3D</span><span class="p">(</span>
   <span class="n">method</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name_plot</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">static</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">plot_meta</span> <span class="o">=</span> <span class="s1">&#39;SET-ID&#39;</span><span class="p">,</span>
   <span class="n">plot_set</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">select</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">same_scale</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">z_axis</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Plot 3D embedding performed with method of choice</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>method</strong> (str) : embedding method</li>
<li><strong>save</strong> (bool, optional) : save plot HTML. Defaults to False.</li>
<li><strong>name_plot</strong> (str, optional) : name of plot's file. Defaults to None.</li>
<li><strong>static</strong> (bool, optional) : return less interactive plot. Defaults to False.</li>
<li><strong>plot_meta</strong> (str, optional) : meta-variale used to color the points. Defaults to "SET-ID".</li>
<li><strong>plot_set</strong> (list, optional) : list of sets to plot from set_collection. Defaults to None.</li>
<li><strong>select</strong> (bool, optional) : return set of buttons to show or hide specific traces. Defaults to False.</li>
<li><strong>same_scale</strong> (bool, optional) : use same color_scale for all traces when scale is continuous. Defaults to False.</li>
</ul>
<p><strong>Raises</strong></p>
<ul>
<li><strong>ValueError</strong>  : method can only be either pcoa or tsne for now</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>plot</strong>  : either interactive or not</li>
</ul>
<h3 id="modules-pear_ebi-tree_set-get_subset">.get_subset<a class="headerlink" href="#modules-pear_ebi-tree_set-get_subset" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/tree_set.py/#L509">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">get_subset</span><span class="p">(</span>
   <span class="n">n_required</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;sequence&#39;</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Gets subset of phylogenetic trees</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>n_required</strong> (int) : number of points to extract</li>
<li><strong>method</strong> (str, optional) : method used to extact points ('sequence', 'random', 'syst'). Defaults to "sequence".</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>plots</strong>  : 2D and 3D embedding plots of subset</li>
</ul>
<hr />
<h2 id="modules-pear_ebi-tree_set-set_collection">set_collection<a class="headerlink" href="#modules-pear_ebi-tree_set-set_collection" title="Permanent link">&para;</a></h2>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/tree_set.py/#L589">source</a>
<div class="highlight"><pre><span></span><code><span class="n">set_collection</span><span class="p">(</span>
   <span class="n">collection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(),</span> <span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;Set_collection_&#39;</span><span class="p">,</span> <span class="n">output_file</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
   <span class="n">distance_matrix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div></p>
<p><strong>Methods:</strong></p>
<h3 id="modules-pear_ebi-tree_set-calculate_distances_1">.calculate_distances<a class="headerlink" href="#modules-pear_ebi-tree_set-calculate_distances_1" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/tree_set.py/#L708">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">calculate_distances</span><span class="p">(</span>
   <span class="n">method</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Computes tree_set distance matrix with method of choice</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>method</strong> (str) : method/algorithm used to compute distance matrix</li>
</ul>
<h3 id="modules-pear_ebi-tree_set-concatenate">.concatenate<a class="headerlink" href="#modules-pear_ebi-tree_set-concatenate" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/tree_set.py/#L803">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
   <span class="n">other</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Concatenates two collectionsor collection and tree_set</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>other</strong> (tree_set ot set_colletion) : tree_set ot set_colletion</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>set_collection</strong>  : concatenated set_collection</li>
</ul></section>
                        <h3 class='nav-section-title' id='section-calculate-distances'>
                            Calculate distances <a class='headerlink' href='#section-calculate-distances' title='Permanent link'>↵</a>
                        </h3>
                        <section class="print-page" id="modules-pear_ebi-calculate_distances-hashrf"><h1 id="modules-pear_ebi-calculate_distances-hashrf-_1"><a class="headerlink" href="#modules-pear_ebi-calculate_distances-hashrf-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-calculate_distances-hashrf-bash_command">bash_command<a class="headerlink" href="#modules-pear_ebi-calculate_distances-hashrf-bash_command" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/hashrf.py/#L14">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">bash_command</span><span class="p">(</span>
   <span class="n">cmd</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Executes bash command in subprocess</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>cmd</strong> (str) : bash command to be runned in subprocess</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>0</strong>  : returns 0 if everything's alright</li>
</ul>
<hr />
<h3 id="modules-pear_ebi-calculate_distances-hashrf-hashrf">hashrf<a class="headerlink" href="#modules-pear_ebi-calculate_distances-hashrf-hashrf" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/hashrf.py/#L45">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">hashrf</span><span class="p">(</span>
   <span class="n">file</span><span class="p">,</span> <span class="n">n_trees</span><span class="p">,</span> <span class="n">output_file</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Computes unweighted Robison Foulds distances</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>file</strong> (str) : name of input file with phylogenetic trees in newick format</li>
<li><strong>n_trees</strong> (int) : number of trees in file</li>
<li><strong>output_file</strong> (str) : name of output file that will contain the distance matrix</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>distance_matrix</strong> (pandas.DataFrame) : computed distance matrix</li>
</ul>
<hr />
<h3 id="modules-pear_ebi-calculate_distances-hashrf-hashrf_weighted">hashrf_weighted<a class="headerlink" href="#modules-pear_ebi-calculate_distances-hashrf-hashrf_weighted" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/hashrf.py/#L98">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">hashrf_weighted</span><span class="p">(</span>
   <span class="n">file</span><span class="p">,</span> <span class="n">n_trees</span><span class="p">,</span> <span class="n">output_file</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Computes weighted Robison Foulds distances</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>file</strong> (str) : name of input file with phylogenetic trees in newick format</li>
<li><strong>n_trees</strong> (int) : number of trees in file</li>
<li><strong>output_file</strong> (str) : name of output file that will contain the distance matrix</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>distance_matrix</strong> (pandas.DataFrame) : computed distance matrix</li>
</ul></section><section class="print-page" id="modules-pear_ebi-calculate_distances-maple_rf"><h1 id="modules-pear_ebi-calculate_distances-maple_rf-_1"><a class="headerlink" href="#modules-pear_ebi-calculate_distances-maple_rf-_1" title="Permanent link">&para;</a></h1>
<h2 id="modules-pear_ebi-calculate_distances-maple_rf-tree">Tree<a class="headerlink" href="#modules-pear_ebi-calculate_distances-maple_rf-tree" title="Permanent link">&para;</a></h2>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/maple_RF.py/#L26">source</a>
<div class="highlight"><pre><span></span><code><span class="n">Tree</span><span class="p">(</span>
   <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="mf">3.3e-05</span>
<span class="p">)</span>
</code></pre></div></p>
<p><strong>Methods:</strong></p>
<h3 id="modules-pear_ebi-calculate_distances-maple_rf-add_child">.add_child<a class="headerlink" href="#modules-pear_ebi-calculate_distances-maple_rf-add_child" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/maple_RF.py/#L49">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">add_child</span><span class="p">(</span>
   <span class="n">node</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<h3 id="modules-pear_ebi-calculate_distances-maple_rf-readnewick">readNewick<a class="headerlink" href="#modules-pear_ebi-calculate_distances-maple_rf-readnewick" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/maple_RF.py/#L55">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">readNewick</span><span class="p">(</span>
   <span class="n">tree_list</span><span class="p">,</span> <span class="n">defaultBLen</span> <span class="o">=</span> <span class="mf">3.3e-05</span><span class="p">,</span> <span class="n">normalizeInputBLen</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>From a list of strings defining phylogenetic trees
in newick format, returns a list of Tree instances
containing the biartitions of the tree in a
modularized form, suitable for comparisons with other trees.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>tree_list</strong> (list) : list of trees in newick format.</li>
<li><strong>defaultBLen</strong> (float, optional) : default branch length. Defaults to 0.000033.</li>
<li><strong>normalizeInputBLen</strong> (float, optional) : value used to normalize branch lenghts. Defaults to 1.0.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>trees</strong>  : list of Tree instances</li>
</ul>
<hr />
<h3 id="modules-pear_ebi-calculate_distances-maple_rf-preparetreecomparison">prepareTreeComparison<a class="headerlink" href="#modules-pear_ebi-calculate_distances-maple_rf-preparetreecomparison" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/maple_RF.py/#L156">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">prepareTreeComparison</span><span class="p">(</span>
   <span class="n">t1</span><span class="p">,</span> <span class="n">rooted</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">minimumBLen</span> <span class="o">=</span> <span class="mf">6e-06</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Prepares newick tree for comparison</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>t1</strong> (str) : input tree</li>
<li><strong>rooted</strong> (bool, optional) : set to True if t1 is rooted, default ro False</li>
<li><strong>minimumBLen</strong> (float, optional) : minimum value for branch length, default to 6E-6</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>metrics</strong> (tuple of values) (leafNameDict, nodeTable, leafCount, numBranches, leafDistDict, branchLengthDict, sumBranchLengths,) : tree metrics among which the RFL.</li>
</ul>
<hr />
<h3 id="modules-pear_ebi-calculate_distances-maple_rf-robinsonfouldswithday1985">RobinsonFouldsWithDay1985<a class="headerlink" href="#modules-pear_ebi-calculate_distances-maple_rf-robinsonfouldswithday1985" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/maple_RF.py/#L332">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">RobinsonFouldsWithDay1985</span><span class="p">(</span>
   <span class="n">t2</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">rooted</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">minimumBLen</span> <span class="o">=</span> <span class="mf">6e-06</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Computes Robison Foulds distances using Day's algorithm</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>t2</strong> (string) : newick tree to be compared to t1</li>
<li><strong>t1</strong> (tuple) : t1 after preprocessing using prepareTreeComparison()</li>
<li><strong>rooted</strong> (bool, optional) : True if t2 is rooted. Defaults to False.</li>
<li><strong>minimumBLen</strong> (float, optional) : minimum branch length. Defaults to 0.000006.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>parameters</strong> (tuple) (numDiffs, float(numDiffs) / (normalization), leafCount, foundBranches, missedBranches, (numBranches - foundBranches), RFL) : results of comparison, among which the RF distance (numDiffs).</li>
</ul>
<hr />
<h3 id="modules-pear_ebi-calculate_distances-maple_rf-calculate_distance_matrix">calculate_distance_matrix<a class="headerlink" href="#modules-pear_ebi-calculate_distances-maple_rf-calculate_distance_matrix" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/maple_RF.py/#L494">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">calculate_distance_matrix</span><span class="p">(</span>
   <span class="n">file</span><span class="p">,</span> <span class="n">n_trees</span><span class="p">,</span> <span class="n">output_file</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Computes the whole pipeline that calculates the pairwise distances in a collection of trees</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>file</strong> (str) : file containing the newick trees</li>
<li><strong>n_trees</strong> (int) : number of trees (or lines) in file</li>
<li><strong>output_file</strong> (str) : output file for distance matrix</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>distance_matrix</strong> (np.array) : distance matrix</li>
</ul></section><section class="print-page" id="modules-pear_ebi-calculate_distances-tqdist"><h1 id="modules-pear_ebi-calculate_distances-tqdist-_1"><a class="headerlink" href="#modules-pear_ebi-calculate_distances-tqdist-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-calculate_distances-tqdist-bash_command">bash_command<a class="headerlink" href="#modules-pear_ebi-calculate_distances-tqdist-bash_command" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/tqdist.py/#L14">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">bash_command</span><span class="p">(</span>
   <span class="n">cmd</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Executes bash command in subprocess</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>cmd</strong> (str) : bash command to be runned in subprocess</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>0</strong>  : returns 0 if everything's alright</li>
</ul>
<hr />
<h3 id="modules-pear_ebi-calculate_distances-tqdist-quartet">quartet<a class="headerlink" href="#modules-pear_ebi-calculate_distances-tqdist-quartet" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/tqdist.py/#L56">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">quartet</span><span class="p">(</span>
   <span class="n">file</span><span class="p">,</span> <span class="n">n_trees</span><span class="p">,</span> <span class="n">output_file</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Computes quartet distances</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>file</strong> (str) : name of input file with phylogenetic trees in newick format</li>
<li><strong>n_trees</strong> (int) : number of trees in file</li>
<li><strong>output_file</strong> (str) : name of output file that will contain the distance matrix</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>distance_matrix</strong> (pandas.DataFrame) : computed distance matrix</li>
</ul>
<hr />
<h3 id="modules-pear_ebi-calculate_distances-tqdist-triplet">triplet<a class="headerlink" href="#modules-pear_ebi-calculate_distances-tqdist-triplet" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/calculate_distances/tqdist.py/#L107">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">triplet</span><span class="p">(</span>
   <span class="n">file</span><span class="p">,</span> <span class="n">n_trees</span><span class="p">,</span> <span class="n">output_file</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Computes triplet distances</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>file</strong> (str) : name of input file with phylogenetic trees in newick format</li>
<li><strong>n_trees</strong> (int) : number of trees in file</li>
<li><strong>output_file</strong> (str) : name of output file that will contain the distance matrix</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>distance_matrix</strong> (pandas.DataFrame) : computed distance matrix</li>
</ul></section><h1 class='nav-section-title-end'>Ended: Calculate distances</h1>
                        <h3 class='nav-section-title' id='section-embeddings'>
                            Embeddings <a class='headerlink' href='#section-embeddings' title='Permanent link'>↵</a>
                        </h3>
                        <section class="print-page" id="modules-pear_ebi-embeddings-isomap_e"><h1 id="modules-pear_ebi-embeddings-isomap_e-_1"><a class="headerlink" href="#modules-pear_ebi-embeddings-isomap_e-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-embeddings-isomap_e-isomap">isomap<a class="headerlink" href="#modules-pear_ebi-embeddings-isomap_e-isomap" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/embeddings/Isomap_e.py/#L12">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">isomap</span><span class="p">(</span>
   <span class="n">distance_matrix</span><span class="p">,</span> <span class="n">n_components</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quality</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">report</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>embed distance_matrix in n_components with Isomap</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>distance_matrix</strong> (pandas.DataFrame) : distance_matrix</li>
<li><strong>n_components</strong> (int) : number of desired components</li>
<li><strong>metadata</strong> (pandas.DataFrame, optional) : metadata of elements. Defaults to None.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>components</strong> (numpy.array) : embedding of distance matrix</li>
</ul></section><section class="print-page" id="modules-pear_ebi-embeddings-lle_e"><h1 id="modules-pear_ebi-embeddings-lle_e-_1"><a class="headerlink" href="#modules-pear_ebi-embeddings-lle_e-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-embeddings-lle_e-lle">lle<a class="headerlink" href="#modules-pear_ebi-embeddings-lle_e-lle" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/embeddings/LLE_e.py/#L12">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">lle</span><span class="p">(</span>
   <span class="n">distance_matrix</span><span class="p">,</span> <span class="n">n_components</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quality</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">report</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>embed distance_matrix in n_components with Locally Linear Embedding</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>distance_matrix</strong> (pandas.DataFrame) : distance_matrix</li>
<li><strong>n_components</strong> (int) : number of desired components</li>
<li><strong>metadata</strong> (pandas.DataFrame, optional) : metadata of elements. Defaults to None.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>components</strong> (numpy.array) : Embedding of distance matrix</li>
</ul></section><section class="print-page" id="modules-pear_ebi-embeddings-pcoa_e"><h1 id="modules-pear_ebi-embeddings-pcoa_e-_1"><a class="headerlink" href="#modules-pear_ebi-embeddings-pcoa_e-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-embeddings-pcoa_e-pcoa">pcoa<a class="headerlink" href="#modules-pear_ebi-embeddings-pcoa_e-pcoa" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/embeddings/PCoA_e.py/#L12">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">pcoa</span><span class="p">(</span>
   <span class="n">distance_matrix</span><span class="p">,</span> <span class="n">n_components</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quality</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">report</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>embed distance_matrix in n_components with Principal Coordinate Analysis</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>distance_matrix</strong> (pandas.DataFrame) : distance_matrix</li>
<li><strong>n_components</strong> (int) : number of desired components</li>
<li><strong>metadata</strong> (pandas.DataFrame, optional) : metadata of elements. Defaults to None.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>components</strong> (numpy.array) : principal coordinates(components) of distance matrix</li>
</ul></section><section class="print-page" id="modules-pear_ebi-embeddings-emb_quality"><h1 id="modules-pear_ebi-embeddings-emb_quality-_1"><a class="headerlink" href="#modules-pear_ebi-embeddings-emb_quality-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-embeddings-emb_quality-euclidean_distance">euclidean_distance<a class="headerlink" href="#modules-pear_ebi-embeddings-emb_quality-euclidean_distance" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/embeddings/emb_quality.py/#L6">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">euclidean_distance</span><span class="p">(</span>
   <span class="n">distances</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Computes euclidean distances - norm of vectors</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>distances</strong> (np.array) : n-dimensional coordinates of points</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>euxlidean_distances</strong> (np.array) : array with euclidean distances</li>
</ul>
<hr />
<h3 id="modules-pear_ebi-embeddings-emb_quality-pear_correlation">pear_correlation<a class="headerlink" href="#modules-pear_ebi-embeddings-emb_quality-pear_correlation" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/embeddings/emb_quality.py/#L19">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">pear_correlation</span><span class="p">(</span>
   <span class="n">distance_matrix</span><span class="p">,</span> <span class="n">embedding</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Computes pearson correlation between euclidean distances
in different dimensionalities</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>distance_matrix</strong> (np.array) : n-dimensional distance matrix</li>
<li><strong>embedding</strong> (np.array) : (m &lt; n)-dimensional embedding</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>correlation</strong> (float) : pearson correlation</li>
</ul>
<hr />
<h3 id="modules-pear_ebi-embeddings-emb_quality-drm">DRM<a class="headerlink" href="#modules-pear_ebi-embeddings-emb_quality-drm" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/embeddings/emb_quality.py/#L35">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">DRM</span><span class="p">(</span>
   <span class="n">distance_matrix</span><span class="p">,</span> <span class="n">embedding</span><span class="p">,</span> <span class="n">inverse_emb</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Return DRM object from https://github.com/zhangys11/pyDRMetrics</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>distance_matrix</strong> (np.array) : n-dimensional distance matrix</li>
<li><strong>embedding</strong> (np.array) : (m &lt; n)-dimensional embedding</li>
<li><strong>inverse_emb</strong> (np.array) : reverse fit of model on embeddings</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>DRM</strong>  : DRM object with quality metrics</li>
</ul></section><section class="print-page" id="modules-pear_ebi-embeddings-tsne_e"><h1 id="modules-pear_ebi-embeddings-tsne_e-_1"><a class="headerlink" href="#modules-pear_ebi-embeddings-tsne_e-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-embeddings-tsne_e-tsne">tsne<a class="headerlink" href="#modules-pear_ebi-embeddings-tsne_e-tsne" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/embeddings/tSNE_e.py/#L12">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">tsne</span><span class="p">(</span>
   <span class="n">distance_matrix</span><span class="p">,</span> <span class="n">n_dimensions</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quality</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">report</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>embed distance_matrix in n_components with t-Stochastic Neighbor Embedding</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>distance_matrix</strong> (pandas.DataFrame) : distance_matrix</li>
<li><strong>n_dimensions</strong> (int) : number of desired dimensions</li>
<li><strong>metadata</strong> (pandas.DataFrame, optional) : metadata of elements. Defaults to None.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>Distances_embedded_ND</strong> (numpy.array) : distances embedded in n_dimensions</li>
</ul></section>
                        <h4 class='nav-section-title' id='section-graph'>
                            Graph <a class='headerlink' href='#section-graph' title='Permanent link'>↵</a>
                        </h4>
                        <section class="print-page" id="modules-pear_ebi-embeddings-graph-graph"><h1 id="modules-pear_ebi-embeddings-graph-graph-_1"><a class="headerlink" href="#modules-pear_ebi-embeddings-graph-graph-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-embeddings-graph-graph-plot_embedding">plot_embedding<a class="headerlink" href="#modules-pear_ebi-embeddings-graph-graph-plot_embedding" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/embeddings/graph/graph.py/#L20">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">plot_embedding</span><span class="p">(</span>
   <span class="n">data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name_plot</span> <span class="o">=</span> <span class="s1">&#39;Tree_embedding&#39;</span><span class="p">,</span>
   <span class="n">static</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">plot_meta</span> <span class="o">=</span> <span class="s1">&#39;SET-ID&#39;</span><span class="p">,</span> <span class="n">plot_set</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">select</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
   <span class="n">same_scale</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">z_axis</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Plot embedding of distance matrix - in 2D or 3D</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>data</strong> (pandas.DataFrame) : embedding of distance matrix</li>
<li><strong>metadata</strong> (pandas.DataFrame) : metadata of tree_set or set_collection</li>
<li><strong>dimensions</strong> (int) : number of dimensions - either 2 or 3</li>
<li><strong>save</strong> (bool, optional) : save plot in pdf format. Defaults to False.</li>
<li><strong>name_plot</strong> (str, optional) : name of plot. Defaults to 'Tree_embedding'.</li>
<li><strong>static</strong> (bool, optional) : if True, returns a less interactive format of plot. Defaults to False.</li>
<li><strong>plot_meta</strong> (str, optional) : defines the meta-feature used to color the points. Defaults to 'SET-ID'.</li>
<li><strong>plot_set</strong> (list or str, optional) : sets in set_collection to be plotted. Defaults to None.</li>
<li><strong>select</strong> (bool, optional) : if True, generates widgets that allow to show or hide uo to 16 set traces. Defaults to False.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>image</strong>  : plot with related widgets - interactive or static format</li>
</ul></section><h1 class='nav-section-title-end'>Ended: Graph</h1><h1 class='nav-section-title-end'>Ended: Embeddings</h1>
                        <h3 class='nav-section-title' id='section-interactive-mode'>
                            Interactive mode <a class='headerlink' href='#section-interactive-mode' title='Permanent link'>↵</a>
                        </h3>
                        <section class="print-page" id="modules-pear_ebi-interactive_mode-interactive"><h1 id="modules-pear_ebi-interactive_mode-interactive-_1"><a class="headerlink" href="#modules-pear_ebi-interactive_mode-interactive-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-interactive_mode-interactive-usage">usage<a class="headerlink" href="#modules-pear_ebi-interactive_mode-interactive-usage" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/interactive_mode/interactive.py/#L18">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">usage</span><span class="p">()</span>
</code></pre></div></p>
<hr />
<h3 id="modules-pear_ebi-interactive_mode-interactive-exit_program">exit_program<a class="headerlink" href="#modules-pear_ebi-interactive_mode-interactive-exit_program" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/interactive_mode/interactive.py/#L37">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">exit_program</span><span class="p">()</span>
</code></pre></div></p>
<hr />
<h3 id="modules-pear_ebi-interactive_mode-interactive-calculate_distances">calculate_distances<a class="headerlink" href="#modules-pear_ebi-interactive_mode-interactive-calculate_distances" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/interactive_mode/interactive.py/#L42">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">calculate_distances</span><span class="p">(</span>
   <span class="n">SET</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<h3 id="modules-pear_ebi-interactive_mode-interactive-embedding">embedding<a class="headerlink" href="#modules-pear_ebi-interactive_mode-interactive-embedding" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/interactive_mode/interactive.py/#L62">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">embedding</span><span class="p">(</span>
   <span class="n">SET</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<h3 id="modules-pear_ebi-interactive_mode-interactive-plotting">plotting<a class="headerlink" href="#modules-pear_ebi-interactive_mode-interactive-plotting" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/interactive_mode/interactive.py/#L89">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">plotting</span><span class="p">(</span>
   <span class="n">SET</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<h3 id="modules-pear_ebi-interactive_mode-interactive-add_set">add_set<a class="headerlink" href="#modules-pear_ebi-interactive_mode-interactive-add_set" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/interactive_mode/interactive.py/#L130">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">add_set</span><span class="p">()</span>
</code></pre></div></p>
<hr />
<h3 id="modules-pear_ebi-interactive_mode-interactive-get_subset">get_subset<a class="headerlink" href="#modules-pear_ebi-interactive_mode-interactive-get_subset" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/interactive_mode/interactive.py/#L142">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">get_subset</span><span class="p">(</span>
   <span class="n">SET</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<h3 id="modules-pear_ebi-interactive_mode-interactive-interact">interact<a class="headerlink" href="#modules-pear_ebi-interactive_mode-interactive-interact" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/interactive_mode/interactive.py/#L170">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
   <span class="n">control</span>
<span class="p">)</span>
</code></pre></div></p></section><h1 class='nav-section-title-end'>Ended: Interactive mode</h1>
                        <h3 class='nav-section-title' id='section-subsample'>
                            Subsample <a class='headerlink' href='#section-subsample' title='Permanent link'>↵</a>
                        </h3>
                        <section class="print-page" id="modules-pear_ebi-subsample-subsample"><h1 id="modules-pear_ebi-subsample-subsample-_1"><a class="headerlink" href="#modules-pear_ebi-subsample-subsample-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-subsample-subsample-subsample">subsample<a class="headerlink" href="#modules-pear_ebi-subsample-subsample-subsample" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/subsample/subsample.py/#L17">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">subsample</span><span class="p">(</span>
   <span class="n">file</span><span class="p">,</span> <span class="n">n_trees</span><span class="p">,</span> <span class="n">n_required</span><span class="p">,</span> <span class="n">subp</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>subsample a set of trees considering their
   distribution in the n_trees dimensional space.
   It tries to maximize the distance between the
   points in the sample considering the pairwise distance
   with respect to the furthest points found at a certain step.
   If the distance of a sample point P is not greater than
   the one between MD1 &amp; MD2, then a random value is
   retrieved from a uniform distribution {0,1}. If the
   value is greater than 0.5, then the point is kept,
   else discarded. This allows to sample also considering
   the density of the points.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>file</strong> (str) : name of file containing the set of trees in newick format.</li>
<li><strong>n_trees</strong> (int) : number of trees in set.</li>
<li><strong>n_required</strong> (int) : number of trees in subsample.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>points</strong> (list) : list of trees subsampled.</li>
<li><strong>idxs</strong> (list) : list of indexes of the trees subsampled.</li>
</ul></section><section class="print-page" id="modules-pear_ebi-subsample-subsample_multiprocess"><h1 id="modules-pear_ebi-subsample-subsample_multiprocess-_1"><a class="headerlink" href="#modules-pear_ebi-subsample-subsample_multiprocess-_1" title="Permanent link">&para;</a></h1>
<h3 id="modules-pear_ebi-subsample-subsample_multiprocess-subsample">subsample<a class="headerlink" href="#modules-pear_ebi-subsample-subsample_multiprocess-subsample" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/pear_ebi/subsample/subsample_multiprocess.py/#L23">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">subsample</span><span class="p">(</span>
   <span class="n">file</span><span class="p">,</span> <span class="n">n_trees</span><span class="p">,</span> <span class="n">n_required</span><span class="p">,</span> <span class="n">subp</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>subsample a set of trees considering their
   distribution in the n_trees dimensional space.
   It tries to maximize the distance between the
   points in the sample considering the pairwise distance
   with respect to the furthest points found at a certain step.
   If the distance of a sample point P is not greater than
   the one between MD1 &amp; MD2, then a random value is
   retrieved from a uniform distribution {0,1}. If the
   value is greater than 0.5, then the point is kept,
   else discarded. This allows to sample also considering
   the density of the points.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>file</strong> (str) : name of file containing the set of trees in newick format.</li>
<li><strong>n_trees</strong> (int) : number of trees in set.</li>
<li><strong>n_required</strong> (int) : number of trees in subsample.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>points</strong> (list) : list of trees subsampled.</li>
<li><strong>idxs</strong> (list) : list of indexes of the trees subsampled.</li>
</ul></section><h1 class='nav-section-title-end'>Ended: Subsample</h1><h1 class='nav-section-title-end'>Ended: Pear ebi</h1>
                        <h2 class='nav-section-title' id='section-test'>
                            Test <a class='headerlink' href='#section-test' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="modules-test-test"><h1 id="modules-test-test-_1"><a class="headerlink" href="#modules-test-test-_1" title="Permanent link">&para;</a></h1>
<h2 id="modules-test-test-testpear">TestPEAR<a class="headerlink" href="#modules-test-test-testpear" title="Permanent link">&para;</a></h2>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/test/test.py/#L31">source</a>
<div class="highlight"><pre><span></span><code><span class="n">TestPEAR</span><span class="p">()</span>
</code></pre></div></p>
<p><strong>Methods:</strong></p>
<h3 id="modules-test-test-setup">.setUp<a class="headerlink" href="#modules-test-test-setup" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/test/test.py/#L32">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
</code></pre></div></p>
<h3 id="modules-test-test-test_init">.test_init<a class="headerlink" href="#modules-test-test-test_init" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/test/test.py/#L36">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">test_init</span><span class="p">()</span>
</code></pre></div></p>
<h3 id="modules-test-test-test_calculate_distances">.test_calculate_distances<a class="headerlink" href="#modules-test-test-test_calculate_distances" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/test/test.py/#L41">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">test_calculate_distances</span><span class="p">()</span>
</code></pre></div></p>
<h3 id="modules-test-test-test_compute_embeddings">.test_compute_embeddings<a class="headerlink" href="#modules-test-test-test_compute_embeddings" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/test/test.py/#L61">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">test_compute_embeddings</span><span class="p">()</span>
</code></pre></div></p>
<h3 id="modules-test-test-test_graph">.test_graph<a class="headerlink" href="#modules-test-test-test_graph" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AndreaRubbi/Pear-EBI/blob/master/test/test.py/#L74">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">test_graph</span><span class="p">()</span>
</code></pre></div></p></section><h1 class='nav-section-title-end'>Ended: Test</h1><h1 class='nav-section-title-end'>Ended: Modules</h1>
                        <h1 class='nav-section-title' id='section-tutorials'>
                            Tutorials <a class='headerlink' href='#section-tutorials' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="tutorials-1how_to_use_pear_ebi"><h1 id="tutorials-1how_to_use_pear_ebi-1-how-to-use-pear">1. How to use Pear<a class="headerlink" href="#tutorials-1how_to_use_pear_ebi-1-how-to-use-pear" title="Permanent link">&para;</a></h1>
<p>This tutorial goes through the basic features of pear_ebi and how to use them</p>
<hr />
<h2 id="tutorials-1how_to_use_pear_ebi-setup">Setup<a class="headerlink" href="#tutorials-1how_to_use_pear_ebi-setup" title="Permanent link">&para;</a></h2>
<p>First of all, check that you have a python version that is supported (python 3.7, 3.8, 3.9). We strongly encourage the creation of a dedicated virtual environment in order to avoid potential conflicts with other libraries due to the mismatch of dependencies' versions. We also support the use of mamba as a more efficient version of conda.</p>
<p><b>In your terminal:</b><br><br>
Download and install mamba: <br>
<a href="https://mamba.readthedocs.io/en/latest/installation/mamba-installation.html">See documentation</a>
<br>Create new environment with one of the supported versions of python:<br>
<code>mamba create -n pear_env python=3.9</code>
<br>Activate environment:<br>
<code>mamba activate pear_ev</code>
<br>Install pear:<br>
<code>python -m pip install pear_ebi</code></p>
<p><br><font color='red'><b>Alternatively:</b></font><br>
<br>Install virtualenv:<br>
<code>pip install virtualenv</code>
<br>Create new environment with one of the supported versions of python:<br>
<code>python3.9 -m venv pear_env</code>
<br>Activate environment:<br>
<code>source pear_env/bin/activate</code>
<br>Install pear:<br>
<code>python -m pip install pear_ebi</code></p>
<h3 id="tutorials-1how_to_use_pear_ebi-optional">Optional<a class="headerlink" href="#tutorials-1how_to_use_pear_ebi-optional" title="Permanent link">&para;</a></h3>
<p>If you're planning on performing more advanced analyses, such as the ones described in the <b><i>"Advanced Examples"</b></i>, you should install the extended requirements:<br>
<code>python -m pip intall -r requirements.txt</code>
<br>and also install the new jupyter kernel:<br>
<code>python -m ipykernel install --user --name=pear_ebi</code></p>
<hr />
<h2 id="tutorials-1how_to_use_pear_ebi-basic-use">Basic Use<a class="headerlink" href="#tutorials-1how_to_use_pear_ebi-basic-use" title="Permanent link">&para;</a></h2>
<p>After following the steps above to set up pear_ebi, you should be ready to use all the features of pear_ebi!
<br>This notebook is a good guide to learn how to use it and to check that your installation is succesfull. If you should have any problem, please contact us by filing an issue on github.<br>
To start with, simply check your installation by running:</p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pear_ebi</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[31mNo files specified[0m[37m [0m[1;37m([0m[37msee --help for instructions[0m[1;37m)[0m
[93m- Leaving PEAR -[0m
</code></pre></div>

<p>Pear is complaining because no file was given... since it looks like you don't know how to use it, it kindly suggests to seek help using the <code>--help</code> (or simply <code>-h</code>) flag. Good idea!</p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pear_ebi</span> <span class="o">-</span><span class="n">h</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>usage: PEAR [-h] [-o output] [--interactive] [-d distance_matrix]
            [--meta metadata] [-m METHOD] [--pcoa PCOA] [--tsne TSNE] [--plot]
            [--config CONFIG] [--quality] [--dir DIR] [--pattern PATTERN]
            [input ...]

PEAR-EBI v0.1.85 | Phylogeny Embedding and Approximate Representation
Calculates Robison-Foulds distances between large set of trees

positional arguments:
  input                 input file : tree set in newic format

optional arguments:
  -h, --help            show this help message and exit
  -o output             output file : storage of distance matrix
  --interactive, -i     run the program in interactive mode - only the input
                        file, distance matrix, output file, and metadata
                        arguments will be considered
  -d distance_matrix, --dM distance_matrix
                        distance matrix : specify file containing a
                        precomputed distance matrix
  --meta metadata       metadata : csv file with metadata for each tree
  -m METHOD, --method METHOD
                        calculates tree distances using specified method
                        (hashrf_RF, hashrf_wRF, smart_RF, tqdist_quartet,
                        tqdist_triplet)
  --pcoa PCOA           embedding using PCoA: select number of components
                        (int) to be calculated
  --tsne TSNE           embedding using t-SNE: select number of components
                        (int) to be calculated
  --plot, -p            plot embedding in 2 or 3 dimensions
  --config CONFIG, -c CONFIG
                        toml config file
  --quality, -q         asess quality of embedding
  --dir DIR             directory with files
  --pattern PATTERN     pattern of files in directory

Author: Andrea Rubbi - Goldman Group | European Bioinformatics Institute
</code></pre></div>

<p>Essentially, pear_ebi does the following:<ul>
    <li>Reads phylogenetic trees in newick format from one or multiple files;
    <li>Computes the distances between the trees with one of the available metrics (refer to <code>--help</code> to see them and to the manuscript for their specific functions);
    <li>Embeds the distances in a lower dimensional space. Basic usage allows using either PCoA or tSNE;
    <li>Plots the resulting embeddings.
 </ul>
 Why should you use pear_ebi? Because it's <font color='green'><b>simple</b><font color='black'>, <font color='dark orange'><b>fast</b><font color='black'>, and <font color='purple'><b>produces nice graphs</b></font>! </p>
<h3 id="tutorials-1how_to_use_pear_ebi-load-trees">Load trees<a class="headerlink" href="#tutorials-1how_to_use_pear_ebi-load-trees" title="Permanent link">&para;</a></h3>
<p>Pear has two kind of structures for your trees:<ol>
    <li><font color='blue'>tree_set</font>;<li><font color='dark pink'>set_collection</font>.
</ol>
You define a <font color='blue'>tree_set</font> with a set of trees coming from a single file, whereas a <font color='dark pink'>set_collection</font> is composed of trees coming from multiple files, divided into groups depending on the file of origin. In practice, computationally and conceptually, a <font color='dark pink'>set_collection</font> is a set of multiple <font color='blue'>tree_set</font>.
<br>We'll make it clear exploring how we can load trees on pear with a few examples.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># load single set of trees into a tree_set #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">beast_trees</span><span class="o">/</span><span class="n">beast_long</span><span class="o">.</span><span class="n">trees</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m1001[0m trees;
 File: beast_trees/beast_long.trees;
 Distance matrix: not computed.
─────────────────────────────


[93m- Leaving PEAR -[0m
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># load two set of trees into a set_collection #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">beast_trees</span><span class="o">/</span><span class="n">beast_run1</span><span class="o">.</span><span class="n">trees</span> <span class="n">beast_trees</span><span class="o">/</span><span class="n">beast_run2</span><span class="o">.</span><span class="n">trees</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set collection containing [1;36m2002[0m trees;
 File: Set_collection_[93m1bfec55f-592e-43a6-bf2b-4000219b3092[0m;
 Distance matrix: not computed.
─────────────────────────────
beast_run1; Containing [1;36m1001[0m trees.
beast_run2; Containing [1;36m1001[0m trees.


[93m- Leaving PEAR -[0m
</code></pre></div>

<p>Although you may be perplexed about the actual practical difference between these structures, we suggest you keep these questions for the next chapters and bear with us to explore some more funky ways of loading trees onto pear.
<br>In fact, you can avoid boring repetitions of the path of your files and simply indicate the directory! </p>
<div class="highlight"><pre><span></span><code><span class="c1"># load files from directory #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="o">--</span><span class="nb">dir</span> <span class="n">beast_trees</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set collection containing [1;36m9009[0m trees;
 File: Set_collection_[93m696e3bb7-7deb-46e1-97c8-3bcce630cddd[0m;
 Distance matrix: not computed.
─────────────────────────────
beast_run7; Containing [1;36m1001[0m trees.
beast_run2; Containing [1;36m1001[0m trees.
beast_long; Containing [1;36m1001[0m trees.
beast_run5; Containing [1;36m1001[0m trees.
beast_run6; Containing [1;36m1001[0m trees.
beast_run3; Containing [1;36m1001[0m trees.
beast_run8; Containing [1;36m1001[0m trees.
beast_run4; Containing [1;36m1001[0m trees.
beast_run1; Containing [1;36m1001[0m trees.


[93m- Leaving PEAR -[0m
</code></pre></div>

<p>Whoa! Too many... thankfully we can indicate a pattern to look for</p>
<div class="highlight"><pre><span></span><code><span class="c1"># load files from directory using pattern#</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="o">--</span><span class="nb">dir</span> <span class="n">beast_trees</span> <span class="o">--</span><span class="n">pattern</span> <span class="s2">&quot;*run*&quot;</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set collection containing [1;36m8008[0m trees;
 File: Set_collection_[93m9781a60f-d6d7-4ffb-97c3-36d7aed9af4b[0m;
 Distance matrix: not computed.
─────────────────────────────
beast_run7; Containing [1;36m1001[0m trees.
beast_run2; Containing [1;36m1001[0m trees.
beast_run5; Containing [1;36m1001[0m trees.
beast_run6; Containing [1;36m1001[0m trees.
beast_run3; Containing [1;36m1001[0m trees.
beast_run8; Containing [1;36m1001[0m trees.
beast_run4; Containing [1;36m1001[0m trees.
beast_run1; Containing [1;36m1001[0m trees.


[93m- Leaving PEAR -[0m
</code></pre></div>

<p>If you are a regex wizard you can probably select any set of similarly-named files in this way. Me? I generally ask GPT to write the magic formula. <b>NB:</b> you can also use a combination of <code>--dir</code>, <code>--pattern</code>, and normal file definition if one or more files come from other directories. </p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pear_ebi</span> <span class="n">beast_trees</span><span class="o">/</span><span class="n">beast_long</span><span class="o">.</span><span class="n">trees</span> <span class="o">--</span><span class="nb">dir</span> <span class="n">beast_trees</span> <span class="o">--</span><span class="n">pattern</span> <span class="s2">&quot;*run[1,2]*&quot;</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set collection containing [1;36m3003[0m trees;
 File: Set_collection_[93m21d56458-1d6b-4dab-9842-f8a65287e845[0m;
 Distance matrix: not computed.
─────────────────────────────
beast_run2; Containing [1;36m1001[0m trees.
beast_run1; Containing [1;36m1001[0m trees.
beast_long; Containing [1;36m1001[0m trees.


[93m- Leaving PEAR -[0m
</code></pre></div>

<h3 id="tutorials-1how_to_use_pear_ebi-compute-distances">Compute Distances<a class="headerlink" href="#tutorials-1how_to_use_pear_ebi-compute-distances" title="Permanent link">&para;</a></h3>
<p>You can compute the distance matrix using different methods. Each method has a specific purpose, which is outlined in the associated paper. However, in general, the Robison Foulds distance metric is an admittedly good choice. Additionally, pear_ebi computes this metric using the hashrf algorithm, which is the fastest way of computing such metric to date. You can indicate any method available using the <code>-m</code>, or <code>--method</code>, flag. When a metric/method is indicated, pear will use it to compute the distance matrix <b>even if a distance matrix is given</b>, and it <b>will overscribe any previous matrix saved at a file with the same standard format</b> (realistically, this happens only if the matrix was produced using pear during an interactive or advanced session - see the interactive sessions chapter).</p>
<div class="highlight"><pre><span></span><code><span class="c1"># compute Robison Foulds distances using hashrf #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">beast_trees</span><span class="o">/</span><span class="n">beast_run1</span><span class="o">.</span><span class="n">trees</span> <span class="o">-</span><span class="n">m</span> <span class="n">hashrf_RF</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m1001[0m trees;
 File: beast_trees/beast_run1.trees;
 Distance matrix: not computed.
─────────────────────────────

[2K[32m⠙[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mhashrf_RF | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># compute Robison Foulds distances using hashrf #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="o">--</span><span class="nb">dir</span> <span class="n">beast_trees</span> <span class="o">--</span><span class="n">pattern</span> <span class="s2">&quot;*run[12]*&quot;</span> <span class="o">--</span><span class="n">method</span> <span class="n">hashrf_RF</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set collection containing [1;36m2002[0m trees;
 File: Set_collection_[93mc9cf5472-d392-4825-b88f-e9feffdb331a[0m;
 Distance matrix: not computed.
─────────────────────────────
beast_run2; Containing [1;36m1001[0m trees.
beast_run1; Containing [1;36m1001[0m trees.

[2K[32m⠙[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mhashrf_RF | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># compute quartet distances #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">-</span><span class="n">m</span> <span class="n">tqdist_quartet</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: not computed.
─────────────────────────────

[2K[32m⠴[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mtqdist_quartet | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># compute modified RF distances #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">-</span><span class="n">m</span> <span class="n">smart_RF</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: not computed.
─────────────────────────────

[2K[32m⠙[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34msmart_RF | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<p>If you run the exaples above you will notice the difference between the time efficiency of hashrf and any other algorithm. Please note the astonishing performance of that algorithm, especially considering the sensible difference in the number of trees analyzed!</p>
<p>Given that one may want to analyze the distance matrix in multiple ways,
possibly desiring to skip the hefty distance-computation step, we introduced the
convenient <code>-d</code> flag that allows specifying a previosuly computed distance matrix.
<b>Please note that</b> the order of the trees in the distance matrix is preserved and
thus one must be consistent with the input specification when reusing a distance matrix.
Should you disregard this suggestion, we suggest you also disregard your downstream analyses
(and perhaps everything else as well).</p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">-</span><span class="n">m</span> <span class="n">hashrf_RF</span> <span class="o">-</span><span class="n">o</span> <span class="n">precomputed_distance_matrix</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: not computed.
─────────────────────────────

[2K[32m⠴[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mhashrf_RF | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># reusing distances #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">-</span><span class="n">d</span> <span class="n">precomputed_distance_matrix</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: computed.
─────────────────────────────


[93m- Leaving PEAR -[0m
</code></pre></div>

<p>Please note the difference in the input "Distance matrix" status.</p>
<h3 id="tutorials-1how_to_use_pear_ebi-embed-distances">Embed distances<a class="headerlink" href="#tutorials-1how_to_use_pear_ebi-embed-distances" title="Permanent link">&para;</a></h3>
<p>Here we show the easy way of embedding the distances and produce nice plots! First of all, one may choose any number of dimensions <span class="arithmatex">\(M \leq N\)</span>; where <span class="arithmatex">\(N\)</span> is the number of trees and <span class="arithmatex">\(M\)</span> the chosen dimensionality of the embedded space. Note that, should <span class="arithmatex">\(M\)</span> be <span class="arithmatex">\(\lt 3\)</span>, pear will produce only one 2D plot. Whereas, should <span class="arithmatex">\(M\)</span> be <span class="arithmatex">\(\geq 3\)</span> pear will produce a 2D and a 3D plot. Please note that we are currently unable to produce human-friendly representations for <span class="arithmatex">\(\gt 3\)</span>D data... In any case, whichever dimension <span class="arithmatex">\(M\)</span> may be chosen, an <span class="arithmatex">\(M\)</span>-dimensional embedding shall be produced and then saved on the machine.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># compute triplet distances, embed in 2D using pcoa #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">-</span><span class="n">m</span> <span class="n">tqdist_triplet</span> <span class="o">--</span><span class="n">pcoa</span> <span class="mi">2</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: not computed.
─────────────────────────────

[2K[32m⠹[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mtqdist_triplet | Done![0m
[?25l[32m⠋[0m [1;32mEmbedding distances...[0m
[1A[2K[1;34mpcoa | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># compute RF distances, embed in 5D using tsne #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">-</span><span class="n">m</span> <span class="n">hashrf_RF</span> <span class="o">--</span><span class="n">tsne</span> <span class="mi">5</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: not computed.
─────────────────────────────

[2K[32m⠦[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mhashrf_RF | Done![0m
[2K[32m⠸[0m [1;32mEmbedding distances...[0m0m
[1A[2K[1;34mtsne | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<p>Use the <code>--plot</code> flag to show the plots at the end. Note that, when an embedding method is specified, the plots are produced regardless of whether the <code>--plot</code> flag is present or not.  </p>
<div class="highlight"><pre><span></span><code><span class="c1"># compute RF distances, embed in 5D using tsne #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">-</span><span class="n">m</span> <span class="n">hashrf_RF</span> <span class="o">--</span><span class="n">tsne</span> <span class="mi">5</span> <span class="o">--</span><span class="n">plot</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: not computed.
─────────────────────────────

[2K[32m⠴[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mhashrf_RF | Done![0m
[2K[32m⠸[0m [1;32mEmbedding distances...[0m0m
[1A[2K[1;34mtsne | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<p><b>NB:</b> this is something you are expected to run in a terminal, this is why the graph doesn't show up here.</p>
<p>The <code>--quality</code>, or <code>-q</code>, flag indicates to pear to provide some quality metrics for the embedding generated. <br>
The toolset of quality-measures provided by pear may be expanded upon request in the future.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># compute RF distances, embed in 5D using tsne, computing quality #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">-</span><span class="n">m</span> <span class="n">hashrf_RF</span> <span class="o">--</span><span class="n">tsne</span> <span class="mi">5</span> <span class="o">--</span><span class="n">quality</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: not computed.
─────────────────────────────

[2K[32m⠼[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mhashrf_RF | Done![0m
[2K[32m⠼[0m [1;32mEmbedding distances...[0m0m
[1A[2K[1;34mtsne | Done![0m
With [1;36m5[0m components/dimensions, the estimated correlation with the [1;36m32[0m-dimensional
coordinates is [1;36m-0.03[0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># compute RF distances, embed in 2D using pcoa, computing quality #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">-</span><span class="n">m</span> <span class="n">hashrf_RF</span> <span class="o">--</span><span class="n">pcoa</span> <span class="mi">2</span> <span class="o">--</span><span class="n">quality</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: not computed.
─────────────────────────────

[2K[32m⠼[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mhashrf_RF | Done![0m
[?25l[32m⠋[0m [1;32mEmbedding distances...[0m
[1A[2K[1;34mpcoa | Done![0m
With [1;36m2[0m components/dimensions, the explained variance is [1;36m96.56[0m,
 with an estimated correlation [1;36m1.00[0m with the [1;36m32[0m-dimensional coordinates

[93m- Leaving PEAR -[0m
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># compute RF distances, embed in 10D using pcoa, computing quality #</span>
<span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">-</span><span class="n">m</span> <span class="n">hashrf_RF</span> <span class="o">--</span><span class="n">pcoa</span> <span class="mi">10</span> <span class="o">--</span><span class="n">quality</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: not computed.
─────────────────────────────

[2K[32m⠦[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mhashrf_RF | Done![0m
[?25l[32m⠋[0m [1;32mEmbedding distances...[0m
[1A[2K[1;34mpcoa | Done![0m
With [1;36m10[0m components/dimensions, the explained variance is [1;36m99.98[0m,
 with an estimated correlation [1;36m1.00[0m with the [1;36m32[0m-dimensional coordinates

[93m- Leaving PEAR -[0m
</code></pre></div>

<p><i>Pro tip</i>: since in order to compute an embedded space we need the distance matrix first, pear will automatically compute the distances with <code>hashrf_RF</code> when no method is indicated (and no precomputed distance matrix is specified) </p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">--</span><span class="n">pcoa</span> <span class="mi">2</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: not computed.
─────────────────────────────

[2K[32m⠦[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mhashrf_RF | Done![0m
[?25l[32m⠋[0m [1;32mEmbedding distances...[0m
[1A[2K[1;34mpcoa | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<h2 id="tutorials-1how_to_use_pear_ebi-tree_set-vs-set_collection"><font color='blue'>tree_set</font> vs <font color='dark pink'>set_collection</font><a class="headerlink" href="#tutorials-1how_to_use_pear_ebi-tree_set-vs-set_collection" title="Permanent link">&para;</a></h2>
<p>Pear has two kind of structures for your trees:<ol>
    <li><font color='blue'>tree_set</font>;<li><font color='dark pink'>set_collection</font>.
</ol>
<font color='blue'>tree_set</font> allows for analyzing a single set of trees.
<font color='dark pink'>set_collection</font> allows for analyzing multiple set of trees and the divergences between them.
In our interactive plots, <font color='dark pink'>set_collection</font> generates different sets of points that are colored
according to the file of origin. This could be useful, for instance, if one performs multiple runs of a phylogenetic-tree estimating algorithm and wants to assess the robustness/consistency of that method.
<br>The distances computation is overall the same as a square distance matrix is generated, encompassing the whole collection of trees.</p>
<hr />
<h2 id="tutorials-1how_to_use_pear_ebi-interactive-sessions">Interactive Sessions<a class="headerlink" href="#tutorials-1how_to_use_pear_ebi-interactive-sessions" title="Permanent link">&para;</a></h2>
<p>All the above, but staying in the loop!
<br>You can add set of trees iteratively and compute distances/embeddings as many times as you want to. </p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pear_ebi</span> <span class="o">-</span><span class="n">i</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mSpecify file with tree set[0m

File: ^C

[93m- Leaving PEAR -[0m
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pear_ebi</span> <span class="n">MAPLE_res</span><span class="o">/</span><span class="n">IQtreeStartingTree_slower_Trees</span> <span class="o">-</span><span class="n">i</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set containing [1;36m32[0m trees;
 File: MAPLE_res/IQtreeStartingTree_slower_Trees;
 Distance matrix: not computed.
─────────────────────────────

[1;32mPEAR | Interactive Mode[0m
[32m⣿⣿⣿⣿⣿⣿⣿⣿⠿⣟⠉⡿⠿⣿⣿⣿⣿⣿⣿⣿[0m[1;37m -- Controls --[0m
[32m⣿⣿⣿⣿⡿⣿⢉⢳⠴⣞⠉⡷⢥⡏⡙⡿⢿⣿⣿⣿[0m[1;37m [0m[1;37m1[0m[1;37m --&gt; see status[0m
[32m⣿⣿⡋⢻⡤⣼⠉⢯⡆⣞⠙⣧⣢⠏⠪⣣⢦⡛⠹⣿[0m[1;37m [0m[1;37m2[0m[1;37m --&gt; calculate distances[0m
[32m⣿⣿⠓⢻⣄⣼⠋⢷⡠⡽⠚⣉⣤⡞⢚⢦⢢⠟⠹⣿[0m[1;37m [0m[1;37m3[0m[1;37m --&gt; embed distances[0m
[32m⣿⣿⢓⢻⡄⡼⠗⢃⣂⡒⠻⣧⣂⡿⠚⣨⢨⡓⠻⣿[0m[1;37m [0m[1;37m4[0m[1;37m --&gt; plot embeddings[0m
[32m⣿⣿⠗⢎⢄⠂⠾⣯⣂⡽⢓⢆⢔⠐⠿⣇⢅⡗⠻⣿[0m[1;37m [0m[1;37m5[0m[1;37m --&gt; add set to collection[0m
[32m⣿⣿⠖⢯⡡⣹⠗⣤⣉⠛⠶⣏⢌⡿⠲⡌⢌⢞⠼⣿[0m[1;37m [0m[1;37m6[0m[1;37m --&gt; get subset[0m
[32m⣿⣿⣮⣾⡉⣹⠦⣞⡉⡽⠶⡌⠌⡮⠲⣏⢩⣷⣼⣿[0m
[32m⣿⣿⣿⣿⣿⣿⣤⣞⢉⣳⠥⣏⠍⣧⣵⣿⣿⣿⣿⣿[0m[1;37m [0m[1;37m7[0m[1;37m --&gt; exit[0m
[32m⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣤⣿⣿⣿⣿⣿⣿⣿⣿⣿[0m[1;37m [0m[1;37m8[0m[1;37m --&gt; see list of controls[0m
Command:
</code></pre></div>

<h2 id="tutorials-1how_to_use_pear_ebi-there-is-more">There is more...<a class="headerlink" href="#tutorials-1how_to_use_pear_ebi-there-is-more" title="Permanent link">&para;</a></h2>
<p>the flags <code>--meta</code> and <code>--config</code> introduce another layer of flexibility into our analyses.
<br> Please, refer to the <b><i>"Advanced Examples"</b></i> folder to get a gist of the full potential of pear!</p></section><section class="print-page" id="tutorials-2advanced%20use%20of%20pear_ebi"><h1 id="tutorials-2advanced%20use%20of%20pear_ebi-2-advanced-uses-of-pear">2. Advanced uses of Pear<a class="headerlink" href="#tutorials-2advanced%20use%20of%20pear_ebi-2-advanced-uses-of-pear" title="Permanent link">&para;</a></h1>
<p>Here we introduce some more elaborated ways we can use pear to perform in-depth analyses and produce effective representations of the embedded distance matrices.</p>
<h2 id="tutorials-2advanced%20use%20of%20pear_ebi-peartoml">pear.toml<a class="headerlink" href="#tutorials-2advanced%20use%20of%20pear_ebi-peartoml" title="Permanent link">&para;</a></h2>
<p>Pear will automatically look for a <code>pear.toml</code> file in the working directory, alternatively, a <code>.toml</code> file can be specified using the <code>--config</code> flag. A <code>.toml</code> file is just a convenient way of specifying many parameters. Doing so in an auxiliary file remove excessive clutter in the use of pear and promotes a more standardized way of performing a series of analyses.
<br>We will guide you through the use of this additional tool.</p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">cat</span> <span class="n">template_pear</span><span class="o">.</span><span class="n">toml</span>
</code></pre></div>
<p>Here you can see the <code>pear.toml</code> example stored in the same directory of this notebook. It is a perfect template for your future analyses!
<br>Let's go thorugh all its parts:<ul>
    <li> <code>[trees]</code> contains single file specifications. Each line associated with this key should direct pear to a file containing trees in Newick format. The nomenclature is "file<span class="arithmatex">\(n\)</span>=filename", where <span class="arithmatex">\(n\)</span> is just the index of the file, whereas filename is the path to the file itself.
    <li> <code>[dir]</code> contains directory and pattern specifications. Each directory should contain only tree-containing files, and should be indicated with a . Alternatively, a <code>pattern</code> can be indicated to narrow the research of the files.
    <li> <code>[collection]</code> stores details related to the <code>tree_set</code> or <code>set_collection</code>:<ul>
        <li> <code>output_file</code> specifies an alternative name and path for the distance matrix file;
        <li> <code>distance_matrix</code> indicates the path of a precomputed distance matrix;
        <li> <code>metadata</code> indicates a <code>.csv</code> file containing metadata compatible with the collection. That means that the number of rows in the file should be equal to the number of trees in the collection. The information stored in metadata can be of any type (discrete or continuous) and can subsequently used in the representation of your data in the 3D embedding instead of the 3<span class="arithmatex">\(^{rd}\)</span> dimension, or to color the points (trees). </ul>
    <li> <code>[highlight]</code> allows for specifying specific trees in the set/collection which are going to highlighted in the final plots. The way one specifies this is by giving a list of indexes indicating which trees to be highlighted for a given set (either if that is part of a collection or not). You specify a list for a set by writing "file<span class="arithmatex">\(n\)</span>"if the file has been indexed as such in the <code>[files]</code> argument. Otherwise by using the name of the file (without extension: filename.trees is just filename) if the file has been specified through <code>[dir]</code> selection. <br />
    <li> <code>[distance]</code> specifies the <code>method</code> used to compute the distance matrix. It can be chosen among <code>hashrf_RF</code>, <code>hashrf_wRF</code>, <code>smart_RF</code>, <code>tqdist_quartet</code>, <code>tqdist_triplet</code>.
    <li> <code>[embedding]</code> specifies the <code>method</code> used to compute the embedding of the distance matrix, the <code>dimensions</code> of the embedding, and whether to display the <code>quality</code> or not. Methods are <code>pcoa</code>, <code>tsne</code>, <code>isomap</code>, <code>lle</code>.
    <li> <code>[plot]</code> defines some aspects of the plots produced by pear:<ul>
        <li><code>name_plot</code> specifies the name of the plot produced;
        <li><code>plot_meta</code> indicates which feature to use to color the points in the graph, default value is <code>SET-ID</code> which simply colors by <code>tree_set</code>. A <code>STEP</code> meta-variable is present and indicates the index of a tree in a <code>tree_set</code>, it can be used to color trees when the ordering is important. Other meta-variables can be specified through the <code>[metadata]</code> argument.
        <li> <code>z_axis</code>, similarly to <code>plot_meta</code>, indicates an alternative meta-variable to be used in the plots. The selected meta-variable replaces the 3<span class="arithmatex">\(^{rd}\)</span> dimension in the 3D graphs.
        <li><code>select</code> indicates whether the graph should have a set of interactive buttons to display/hide specific <code>tree_set</code>s or not.
        <li><code>same_scale</code> indicates whether the same colorscale should be applied to every <code>tree_set</code> or not.
        <li><code>show</code> specifies whether the plot should be shown or not.
</ul>
<b>Note that</b> all these arguments are optional, and many of them can be specified otherwise using the normal functionalities of pear. In fact, should any of these arguments be specified using the <code>.toml</code> structure and the flags in pear, the arguments will be overscribed by the ones indicated on the command line. On an additional note related to this, the flag <code>--meta</code> allows to specify on the command line a metadata file, replicating the behaviour of the <code>metadata</code> argument in <code>[collection]</code>.  </p>
<hr />
<h2 id="tutorials-2advanced%20use%20of%20pear_ebi-examples">Examples<a class="headerlink" href="#tutorials-2advanced%20use%20of%20pear_ebi-examples" title="Permanent link">&para;</a></h2>
<h3 id="tutorials-2advanced%20use%20of%20pear_ebi-example-1">Example 1<a class="headerlink" href="#tutorials-2advanced%20use%20of%20pear_ebi-example-1" title="Permanent link">&para;</a></h3>
<p>We use pear to analyze 3 runs of a MCMC algorithm, called Beast, used to estimate a phylogenetic tree structure.<br>
We upload 2 files using the <code>[trees]</code> argument and 1 by specifying the <code>[dir]</code> and a <code>pattern</code>.<br>
We compute the Robinson Foulds distances using hashrf.<br>
We embed the distances in a 3-dimensional space using PCoA, and we plot the results colouring by STEP and highlighting some specific trees for each set. We also display some buttons to hide/show the sets in the plots, we use different colorscales (the default behaviour), and we show the results.</p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">cat</span> <span class="n">example_1</span><span class="o">.</span><span class="n">toml</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pear_ebi</span> <span class="o">--</span><span class="n">config</span> <span class="n">example_1</span><span class="o">.</span><span class="n">toml</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[37mLooking into directory [0m[35m..[0m[35m/beast_trees/[0m[35m [0m[37m- pattern: [0m[35m*run2*[0m
[95mYour input:[0m
─────────────────────────────
 Tree set collection containing [1;36m3003[0m trees;
 File: Set_collection_[93m72c842e8-e1ac-4a90-8fbc-535c4b10ef92[0m;
 Distance matrix: not computed.
─────────────────────────────
beast_run1; Containing [1;36m1001[0m trees.
beast_long; Containing [1;36m1001[0m trees.
beast_run2; Containing [1;36m1001[0m trees.

[2K[32m⠸[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mhashrf_RF | Done![0m
[2K[32m⠋[0m [1;32mEmbedding distances...[0m0m
[1A[2K[1;34mpcoa | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<h4 id="tutorials-2advanced%20use%20of%20pear_ebi-example-1-continued">Example 1 Continued<a class="headerlink" href="#tutorials-2advanced%20use%20of%20pear_ebi-example-1-continued" title="Permanent link">&para;</a></h4>
<p>We now show that we can easily modify a single parameter without touching the <code>.toml</code> file by simply overriding it on the command line. <br>
As an example, we change the embedding method to tSNE.</p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pear_ebi</span> <span class="o">--</span><span class="n">config</span> <span class="n">example_1</span><span class="o">.</span><span class="n">toml</span> <span class="o">--</span><span class="n">tsne</span> <span class="mi">3</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[37mLooking into directory [0m[35m..[0m[35m/beast_trees/[0m[35m [0m[37m- pattern: [0m[35m*run2*[0m
[95mYour input:[0m
─────────────────────────────
 Tree set collection containing [1;36m3003[0m trees;
 File: Set_collection_[93m9a55b5c8-53b6-40c3-b4c7-55df883b3258[0m;
 Distance matrix: not computed.
─────────────────────────────
beast_run1; Containing [1;36m1001[0m trees.
beast_long; Containing [1;36m1001[0m trees.
beast_run2; Containing [1;36m1001[0m trees.

[2K[32m⠼[0m [1;32mCalculating distances...[0m0m
[1A[2K[1;34mhashrf_RF | Done![0m
[2K[32m⠹[0m [1;32mEmbedding distances...[0m0m
[1A[2K[1;34mtsne | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<h3 id="tutorials-2advanced%20use%20of%20pear_ebi-example-2">Example 2<a class="headerlink" href="#tutorials-2advanced%20use%20of%20pear_ebi-example-2" title="Permanent link">&para;</a></h3>
<p>We use pear to compare 5 different algorithms used to estimate a phylogenetic tree structure with the real structure (we know it as we use simulated data).<br>
We upload 6 files using the <code>[trees]</code> argument.<br>
We compute the Robinson Foulds distances using hashrf.<br>
We embed the distances in a 3-dimensional space using PCoA, and we plot the results colouring by the Likelihood values obtained during the runs. We highlight the true tree structure.<br>
We substitute the 3<span class="arithmatex">\(^{rd}\)</span> dimension with the Likelihood scores, and we use the same colorscale to represent the likelihood of the proposed structures.</p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">cat</span> <span class="n">example_2</span><span class="o">.</span><span class="n">toml</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pear_ebi</span> <span class="o">--</span><span class="n">config</span> <span class="n">example_2</span><span class="o">.</span><span class="n">toml</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set collection containing [1;36m138[0m trees;
 File: Set_collection_[93mec4084c4-a5a7-4878-abcc-93c634208b6e[0m;
 Distance matrix: computed.
─────────────────────────────
IQtreeStartingTree_Trees; Containing [1;36m29[0m trees.
MapleStartingTree_Trees; Containing [1;36m5[0m trees.
ParsimonyRAxMLStartingTree_GTRmodel_Trees; Containing [1;36m47[0m trees.
RAxMLNGStartingTree_Trees; Containing [1;36m26[0m trees.
UshERStartingTree_Trees; Containing [1;36m30[0m trees.
TrueTreeSimulations; Containing [1;36m1[0m trees.

[2K[32m⠋[0m [1;32mEmbedding distances...[0m0m
[1A[2K[1;34mpcoa | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div>

<h4 id="tutorials-2advanced%20use%20of%20pear_ebi-example-2-continued">Example 2 Continued<a class="headerlink" href="#tutorials-2advanced%20use%20of%20pear_ebi-example-2-continued" title="Permanent link">&para;</a></h4>
<p>We now show that we can easily run the same analyses in a very neat way by simply renaming our <code>.toml</code> file by simply renaming it <code>pear.toml</code>. </p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pear_ebi</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[34mPEAR v0.[0m[1;34m1.85[0m
[95mYour input:[0m
─────────────────────────────
 Tree set collection containing [1;36m138[0m trees;
 File: Set_collection_[93mb87402e6-2e41-4902-8fd2-092a3f6c230a[0m;
 Distance matrix: computed.
─────────────────────────────
IQtreeStartingTree_Trees; Containing [1;36m29[0m trees.
MapleStartingTree_Trees; Containing [1;36m5[0m trees.
ParsimonyRAxMLStartingTree_GTRmodel_Trees; Containing [1;36m47[0m trees.
RAxMLNGStartingTree_Trees; Containing [1;36m26[0m trees.
UshERStartingTree_Trees; Containing [1;36m30[0m trees.
TrueTreeSimulations; Containing [1;36m1[0m trees.

[2K[32m⠋[0m [1;32mEmbedding distances...[0m0m
[1A[2K[1;34mpcoa | Done![0m

[93m- Leaving PEAR -[0m
</code></pre></div></section><section class="print-page" id="tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper"><h1 id="tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-3-how-to-use-pear-on-python">3. How to use Pear on python<a class="headerlink" href="#tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-3-how-to-use-pear-on-python" title="Permanent link">&para;</a></h1>
<h1></h1>

<p>Here we report the code used to generate the examples in the manuscript, providing a general outline of the use of the python library</p>
<p><code>tree_set</code> is the main module of <code>pear_ebi</code> - it contains both the <font color="blue"><b>tree_set</b></font> and the <font color="red"><b>set_collection</b></font> objects.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pear_ebi</span> <span class="kn">import</span> <span class="n">tree_set</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
</code></pre></div>
<h2 id="tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-examples">Examples<a class="headerlink" href="#tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-examples" title="Permanent link">&para;</a></h2>
<p>Here we do not delve into the specifics or the rationale of the experiments - for that we redirect you to the related manuscript - but rather focus on the use of the library to analyze sets of trees in different settings.</p>
<hr />
<h1 id="tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-beast">BEAST<a class="headerlink" href="#tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-beast" title="Permanent link">&para;</a></h1>
<h3 id="tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-bayesan-markow-chain-monte-carlo"><font color='purple'> Bayesan - Markow Chain Monte Carlo </font><a class="headerlink" href="#tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-bayesan-markow-chain-monte-carlo" title="Permanent link">&para;</a></h3>
<p>This is a relatively simple example: we have a few files containing trees in Newick format, where each set of trees is produced by a program that produced them sequentially. We want to represent the distribution of these trees in order to analyze the single trajectories and to compare the different trjectories coming from different runs. <br>
With this idea in mind, we simply compute the square distance matrix using the <code>Robinson Foulds</code> metric, which generally represents the relations between trees in an effective way, using the most efficient algorithm: <code>hashrf</code>.<br>
We then compute and plot the <code>PCoA</code> embeddings in 2 and 3 dimensions. </p>
<h4 id="tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-step-1-load-trees">Step 1: load trees<a class="headerlink" href="#tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-step-1-load-trees" title="Permanent link">&para;</a></h4>
<p><font color="blue"><b>tree_set</b></font> is meant to store and manage the analysis of a single set of trees stored in the same file. These trees have to be in the (standard) Newick format.<br>
<code>tree_set = tree_set.tree_set(file, output_file=None, distance_matrix=None, metadata=None)</code>
<br>The first argument indicates the file where the trees are stored. <code>output_file</code> can be empty and may be used to indicate a specific name and path for the output distance matrix. <code>distance_matrix</code> can be used to indicate a precomputed distance matrix in the <code>.csv</code> format. <code>metadata</code> may be used to indicate a <code>.csv</code> file with additional information relative to the trees. It must be of the same dimensionality of the set of trees, hence <span class="arithmatex">\(size = (|trees|, |meta\)</span>-<span class="arithmatex">\(variables|)\)</span>. </p>
<hr />
<p><font color="red"><b>set_collection</b></font> performs the same tasks of <font color="blue"><b>tree_set</b></font>, but stores multiple set of trees. <b>NB:</b> for each file, a set of trees is defined within the set collection. In practice, a <font color="red"><b>set_collection</b></font> is a collection of different <font color="blue"><b>tree_set</b></font>, each one containing a set of trees coming from a different file. It should not come as a surprise, then, that the input <code>collection=list()</code>, potentially empty (one may initialize an empty collection), is a list of files containing trees in the Newick format.
<code>set_collection=tree_set.set_collection(collection=list(), file="Set_collection_", output_file=None, distance_matrix=None, metadata=None,)</code>
<br><code>file</code> may be used to indicate an alternative name for the file containing the collection information. This file will be used by pear to store information relative to the sets of trees. <code>output_file</code> may be used to indicate a specific name for the distance matrix file.
<br><code>distance_matrix</code> can be used to indicate a precomputed distance matrix in the <code>.csv</code> format. <code>metadata</code> may be used to indicate a <code>.csv</code> file with additional information relative to the trees. It must be of the same dimensionality of the set of trees, hence <span class="arithmatex">\(size = (|trees|, |meta\)</span>-<span class="arithmatex">\(variables|)\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="n">beast_dir</span> <span class="o">=</span> <span class="s1">&#39;../beast_trees&#39;</span>
<span class="n">beast_runs</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">beast_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;beast_run</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.trees&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">beast_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;beast_long.trees&quot;</span><span class="p">)]</span>
<span class="n">beast_collection</span> <span class="o">=</span> <span class="n">tree_set</span><span class="o">.</span><span class="n">set_collection</span><span class="p">(</span><span class="n">beast_runs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">beast_collection</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>─────────────────────────────
 Tree set collection containing 9009 trees;
 File: Set_collection_d67b3fc3-bac4-4e5f-934c-0c8dc668f012;
 Distance matrix: not computed.
─────────────────────────────
beast_run1; Containing 1001 trees.
beast_run2; Containing 1001 trees.
beast_run3; Containing 1001 trees.
beast_run4; Containing 1001 trees.
beast_run5; Containing 1001 trees.
beast_run6; Containing 1001 trees.
beast_run7; Containing 1001 trees.
beast_run8; Containing 1001 trees.
beast_long; Containing 1001 trees.
</code></pre></div>

<h4 id="tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-step-2-compute-distances">Step 2: compute distances<a class="headerlink" href="#tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-step-2-compute-distances" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">beast_collection</span><span class="o">.</span><span class="n">calculate_distances</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;hashrf_RF&quot;</span><span class="p">)</span>
<span class="c1"># where method can be chosen among hashrf_RF,</span>
<span class="c1"># hashrf_wRF, smart_RF, tqdist_quartet, tqdist_triplet</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>Output()
</code></pre></div>

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">hashrf_RF | Done!</span>
</pre>

<h4 id="tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-step-3-compute-embeddings">Step 3: compute embeddings<a class="headerlink" href="#tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-step-3-compute-embeddings" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">beast_collection</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;pcoa&quot;</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># where method can be chosen among pcoa, tsne, isomap, lle</span>
<span class="c1"># pro tip: if the distance matrix has not been computed prior to calling this function,</span>
<span class="c1"># it will automatically be computed using hashrf_RF</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>Output()
</code></pre></div>

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">pcoa | Done!</span>
</pre>

<h4 id="tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-step-4-plot-embeddings">Step 4: Plot embeddings<a class="headerlink" href="#tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-step-4-plot-embeddings" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">beast_collection</span><span class="o">.</span><span class="n">plot_2D</span><span class="p">(</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">&#39;pcoa&#39;</span><span class="p">,</span> <span class="c1"># method used for the embedding - if not previously computed, it will be computed when calling this function </span>
        <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># save the plot in a pdf format? The .html will be saved anyway!</span>
        <span class="n">name_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># specific name for the plot</span>
        <span class="n">static</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># create a static element rather than a dynamic widget</span>
        <span class="n">plot_meta</span><span class="o">=</span><span class="s2">&quot;SET-ID&quot;</span><span class="p">,</span> <span class="c1"># meta-variable used to colour the points (trees)</span>
        <span class="n">plot_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># select specific set of sets of trees in the collection for the plot</span>
        <span class="n">select</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># create widgets to hide/display tree_sets in the graph</span>
        <span class="n">same_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,)</span> <span class="c1"># use the same colorscale for each tree_set (useful when the same metric is compared among sets)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">beast_collection</span><span class="o">.</span><span class="n">plot_3D</span><span class="p">(</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">&#39;pcoa&#39;</span><span class="p">,</span>
        <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">name_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">static</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot_meta</span><span class="o">=</span><span class="s2">&quot;SET-ID&quot;</span><span class="p">,</span>
        <span class="n">plot_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">select</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">same_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">z_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,)</span> <span class="c1"># substitute the 3rd axis (Z-axis/3rd PCoA) with a meta-variable of choice</span>
</code></pre></div>
<hr />
<h1 id="tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-raxml">RAxML<a class="headerlink" href="#tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-raxml" title="Permanent link">&para;</a></h1>
<h3 id="tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-bootstrap-analysis"><font color='purple'> Bootstrap Analysis </font><a class="headerlink" href="#tutorials-3how%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper-bootstrap-analysis" title="Permanent link">&para;</a></h3>
<p>We do not delve into the biological interpretation of this specific example, as we discussed that in our manuscript. <br> Instead, we point your attention to some specific features of pear's interactive representations: <ul>
    <li> First: you can directly plot the <code>PCoA</code> embedding of the Robinson Foulds distances computed with <code>hashrf</code> without explicitly going through these steps. In fact, running a plotting function bypasses steps 2 and 3, performing them "under the hood";
    <li> In the 2D representation:<ul>
        <li> From the dropdown menu, one can choose the meta-vatiable used to color the points in the graphs;
        <li> The red button "Save plot as pdf" saves the plot in a <code>.pdf</code> file;
        <li> The <span class="arithmatex">\(#show <code>name of the tree set</code>\)</span> buttons allow showing and hiding specific sets of trees;
        <li> One may choose between the scatter representation or a contour plot;
        <li> While visualizing a contour plot, one may choose to hide or show the points (trees) with the light blue button "Show points on a Contour plot";
        <li> One can choose between visualizing only the points or also the connections between them (indicating the progress through an hypotetical sequential order);
        <li> One can use the native tools of the plot so zoom in to focus on a specific area of the graph;
        <li> If one wants to focus their attention on specific sets of trees, they just have to click them: this will highlight the selected set and make the other sets transparent. One may continue and highlight on other sets by simply clicking on them. In order to go back to the original representation, one just needs to click on one of the previously highlighted sets for a second time.
    </ul>
 <br />
<li> In the 3D representation:<ul>
       <li> Same features of the 2D representation. However, there is no contour plot in this case.


<div class="highlight"><pre><span></span><code><span class="n">input_dir</span> <span class="o">=</span> <span class="s1">&#39;../bootstrap_mammals/&#39;</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">([</span><span class="sa">f</span><span class="s1">&#39;bootstrap_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6086</span><span class="p">,</span> <span class="mi">5261</span><span class="p">,</span> <span class="mi">5092</span><span class="p">,</span> <span class="mi">281</span><span class="p">,</span> <span class="mi">11289</span><span class="p">,</span> <span class="mi">10409</span><span class="p">]]</span> <span class="o">+</span>
    <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;bestTree_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6086</span><span class="p">,</span> <span class="mi">5261</span><span class="p">,</span> <span class="mi">5092</span><span class="p">,</span> <span class="mi">281</span><span class="p">,</span> <span class="mi">11289</span><span class="p">,</span> <span class="mi">10409</span><span class="p">]])</span>
<span class="n">collection</span> <span class="o">=</span> <span class="n">tree_set</span><span class="o">.</span><span class="n">set_collection</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
</code></pre></div>

    ─────────────────────────────
     Tree set collection containing 3656 trees;
     File: Set_collection_4cbb9500-1e98-40cd-84ec-a9c8bd511698;
     Distance matrix: not computed.
    ─────────────────────────────
    bootstrap_6086; Containing 500 trees.
    bootstrap_5261; Containing 600 trees.
    bootstrap_5092; Containing 800 trees.
    bootstrap_281; Containing 600 trees.
    bootstrap_11289; Containing 600 trees.
    bootstrap_10409; Containing 550 trees.
    bestTree_6086; Containing 1 trees.
    bestTree_5261; Containing 1 trees.
    bestTree_5092; Containing 1 trees.
    bestTree_281; Containing 1 trees.
    bestTree_11289; Containing 1 trees.
    bestTree_10409; Containing 1 trees.




<div class="highlight"><pre><span></span><code><span class="n">collection</span><span class="o">.</span><span class="n">plot_2D</span><span class="p">(</span><span class="s1">&#39;pcoa&#39;</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="n">collection</span><span class="o">.</span><span class="n">plot_3D</span><span class="p">(</span><span class="s1">&#39;pcoa&#39;</span><span class="p">,</span> <span class="n">select</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>


<h1> MAPLE </h1>
<h3> <font color='purple'> Maximum Likelihood Search </font></h3>

In this specific example, we focus the readers' attention on the possibility of specifying a metadata file to add meta-variable and use them to color the points in the plots or to replace the $Z_{axis}$ in the 3D plot.<br>
In the cell below we specify a list of files containing trees and a list of files containing the likelihood of each tree.


<div class="highlight"><pre><span></span><code><span class="n">maple_tree</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;IQtreeStartingTree_Trees&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MapleStartingTree_Trees&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ParsimonyRAxMLStartingTree_GTRmodel_Trees&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RAxMLNGStartingTree_Trees&quot;</span><span class="p">,</span>
    <span class="s2">&quot;UshERStartingTree_Trees&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TrueTreeSimulations&quot;</span><span class="p">,</span>
    <span class="p">]</span>

<span class="n">maple_LK</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;IQtreeStartingTree_LK&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MapleStartingTree_LK&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ParsimonyRAxMLStartingTree_GTRmodel_LK&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RAxMLNGStartingTree_LK&quot;</span><span class="p">,</span>
    <span class="s2">&quot;UshERStartingTree_LK&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">maple_dir</span> <span class="o">=</span> <span class="s1">&#39;../MAPLE_res/&#39;</span>
</code></pre></div>

In the cell below we check that "DisMat_Maple.csv", the precomputed distance matrix, is present in the folder. We precomputed the distances as the `smart_RF` algorithm, which computes a modified version of the Robinson Foulds metric, takes much longer than `hashrf_RF`.


<div class="highlight"><pre><span></span><code><span class="n">set_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">maple_dir</span><span class="p">,</span> <span class="n">tree</span><span class="p">)</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">maple_tree</span><span class="p">]</span>
<span class="k">try</span><span class="p">:</span><span class="n">collection_maple</span> <span class="o">=</span> <span class="n">tree_set</span><span class="o">.</span><span class="n">set_collection</span><span class="p">(</span><span class="n">set_list</span><span class="p">,</span> <span class="n">distance_matrix</span> <span class="o">=</span> <span class="s2">&quot;DistMat_Maple.csv&quot;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span><span class="n">collection_maple</span> <span class="o">=</span> <span class="n">tree_set</span><span class="o">.</span><span class="n">set_collection</span><span class="p">(</span><span class="n">set_list</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span><span class="nb">print</span><span class="p">(</span><span class="n">collection_maple</span><span class="p">)</span>
</code></pre></div>

    ─────────────────────────────
     Tree set collection containing 138 trees;
     File: Set_collection_17e30756-0754-4fbb-9ed7-cb862716a7f8;
     Distance matrix: computed.
    ─────────────────────────────
    IQtreeStartingTree_Trees; Containing 29 trees.
    MapleStartingTree_Trees; Containing 5 trees.
    ParsimonyRAxMLStartingTree_GTRmodel_Trees; Containing 47 trees.
    RAxMLNGStartingTree_Trees; Containing 26 trees.
    UshERStartingTree_Trees; Containing 30 trees.
    TrueTreeSimulations; Containing 1 trees.



This is how we extracted the information from multiple files - one may simply skip this step as we then saved the information in the "Likelihoods.csv" file.


<div class="highlight"><pre><span></span><code><span class="n">LKs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">lk_file</span> <span class="ow">in</span> <span class="n">maple_LK</span><span class="p">:</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">maple_dir</span><span class="p">,</span> <span class="n">lk_file</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">LKs</span><span class="p">[</span><span class="n">lk_file</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">LK</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">lk</span> <span class="ow">in</span> <span class="n">LKs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span> <span class="n">LK</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lk</span><span class="p">)</span>

<span class="n">LK</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tree</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">LK</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">LK</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">LK</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">257513</span><span class="p">])],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">LK</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">LK</span><span class="p">,</span> <span class="p">(</span><span class="n">LK</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">LK</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="c1"># scale LKs between 0 and 1</span>

<span class="n">df_LK</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;LK&#39;</span><span class="p">:</span><span class="n">LK</span><span class="p">})</span>
<span class="n">df_LK</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;Likelihoods.csv&quot;</span><span class="p">)</span>
<span class="n">df_LK</span>
</code></pre></div>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LK</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.983439</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.983822</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.984404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.985124</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.985631</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>133</th>
      <td>0.999844</td>
    </tr>
    <tr>
      <th>134</th>
      <td>0.999850</td>
    </tr>
    <tr>
      <th>135</th>
      <td>0.999976</td>
    </tr>
    <tr>
      <th>136</th>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>137</th>
      <td>0.706890</td>
    </tr>
  </tbody>
</table>
<p>138 rows × 1 columns</p>
</div>



There are two ways to introduce new variables in a <font color="red"><b>set_collection</b></font>'s or <font color="blue"><b>tree_set</b></font>'s metadata:


<div class="highlight"><pre><span></span><code><span class="c1"># Method 1:</span>
<span class="c1"># Given that metadata is a pandas dataframe, </span>
<span class="c1"># one may simply add columns to it!</span>
<span class="n">df_LK</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Likelihoods.csv&quot;</span><span class="p">)</span>
<span class="n">collection_maple</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;LK&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_LK</span><span class="p">[</span><span class="s1">&#39;LK&#39;</span><span class="p">]</span>
<span class="n">collection_maple</span><span class="o">.</span><span class="n">metadata</span>
</code></pre></div>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SET-ID</th>
      <th>STEP</th>
      <th>LK</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>0</td>
      <td>0.983439</td>
    </tr>
    <tr>
      <th>1</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>1</td>
      <td>0.983822</td>
    </tr>
    <tr>
      <th>2</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>2</td>
      <td>0.984404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>3</td>
      <td>0.985124</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>4</td>
      <td>0.985631</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>133</th>
      <td>UshERStartingTree_Trees</td>
      <td>26</td>
      <td>0.999844</td>
    </tr>
    <tr>
      <th>134</th>
      <td>UshERStartingTree_Trees</td>
      <td>27</td>
      <td>0.999850</td>
    </tr>
    <tr>
      <th>135</th>
      <td>UshERStartingTree_Trees</td>
      <td>28</td>
      <td>0.999976</td>
    </tr>
    <tr>
      <th>136</th>
      <td>UshERStartingTree_Trees</td>
      <td>29</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>137</th>
      <td>TrueTreeSimulations</td>
      <td>0</td>
      <td>0.706890</td>
    </tr>
  </tbody>
</table>
<p>138 rows × 3 columns</p>
</div>




<div class="highlight"><pre><span></span><code><span class="c1"># Method 2:</span>
<span class="c1"># One may specify a file with additional </span>
<span class="c1"># metadata when the object is created</span>
<span class="n">collection_maple</span> <span class="o">=</span> <span class="n">tree_set</span><span class="o">.</span><span class="n">set_collection</span><span class="p">(</span><span class="n">set_list</span><span class="p">,</span> <span class="n">distance_matrix</span> <span class="o">=</span> <span class="s2">&quot;DistMat_Maple.csv&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="s2">&quot;Likelihoods.csv&quot;</span><span class="p">)</span>
<span class="n">collection_maple</span><span class="o">.</span><span class="n">metadata</span>
</code></pre></div>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SET-ID</th>
      <th>STEP</th>
      <th>LK</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>0</td>
      <td>0.983439</td>
    </tr>
    <tr>
      <th>1</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>1</td>
      <td>0.983822</td>
    </tr>
    <tr>
      <th>2</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>2</td>
      <td>0.984404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>3</td>
      <td>0.985124</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>4</td>
      <td>0.985631</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>133</th>
      <td>UshERStartingTree_Trees</td>
      <td>26</td>
      <td>0.999844</td>
    </tr>
    <tr>
      <th>134</th>
      <td>UshERStartingTree_Trees</td>
      <td>27</td>
      <td>0.999850</td>
    </tr>
    <tr>
      <th>135</th>
      <td>UshERStartingTree_Trees</td>
      <td>28</td>
      <td>0.999976</td>
    </tr>
    <tr>
      <th>136</th>
      <td>UshERStartingTree_Trees</td>
      <td>29</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>137</th>
      <td>TrueTreeSimulations</td>
      <td>0</td>
      <td>0.706890</td>
    </tr>
  </tbody>
</table>
<p>138 rows × 3 columns</p>
</div>



If, for any reason, the "DisMat_Maple.csv" is not present in the folder, we need to compute the distance matrix. We chose to upload the precomputed distance matrix as the `smart_RF` method takes much longer to compute than `hashrf_RF`, and we wanted this notebook to run smoothly and rapidly.


<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="n">collection_maple</span><span class="o">.</span><span class="n">distance_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">collection_maple</span><span class="o">.</span><span class="n">calculate_distances</span><span class="p">(</span><span class="s1">&#39;days_RF&#39;</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s2">&quot;DistMat_Maple.csv&quot;</span><span class="p">,</span> <span class="n">collection_maple</span><span class="o">.</span><span class="n">distance_matrix</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
<span class="n">collection_maple</span><span class="o">.</span><span class="n">distance_matrix</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div>




    (138, 138)



We colour the trees based on their likelihood in the 2D plot, while we replace the $Z_{axis}$ with the likelihood in the 3D plot. <br>
`same_scale` makes sure that points with the same value have the same colour in the graphs.


<div class="highlight"><pre><span></span><code><span class="n">collection_maple</span><span class="o">.</span><span class="n">plot_3D</span><span class="p">(</span><span class="s1">&#39;pcoa&#39;</span><span class="p">,</span> <span class="n">plot_meta</span> <span class="o">=</span> <span class="s1">&#39;LK&#39;</span><span class="p">,</span> <span class="n">same_scale</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">select</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="n">collection_maple</span><span class="o">.</span><span class="n">plot_3D</span><span class="p">(</span><span class="s1">&#39;pcoa&#39;</span><span class="p">,</span> <span class="n">plot_meta</span> <span class="o">=</span> <span class="s1">&#39;LK&#39;</span><span class="p">,</span> <span class="n">same_scale</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">select</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">z_axis</span> <span class="o">=</span> <span class="s1">&#39;LK&#39;</span><span class="p">)</span>
</code></pre></div>

What if I wanted to make one of these trees to "pop out"? Well, we can add a coulumn called `"highlight"` that will automatically be read by the plotting function to "highloght" the points specified. The columns has to be binary (0s and 1s), where the 1s indicate that a tree should be highlighted. It is crucial here to know the order and size of the sets, as the column is shared by the whole collection. <b>Note that</b>: the vector `"highlight"` <b>must be integer (dtype = int)!</b>.

<h4> Easy example:</h4>
we want to highight the true tree, which is the last in the collection.


<div class="highlight"><pre><span></span><code><span class="n">highlight_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">collection_maple</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># vector of 0s with size = n_trees</span>
<span class="n">highlight_mask</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># last element set to 1</span>
<span class="n">collection_maple</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;highlight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">highlight_mask</span>
<span class="n">collection_maple</span><span class="o">.</span><span class="n">metadata</span>
</code></pre></div>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SET-ID</th>
      <th>STEP</th>
      <th>LK</th>
      <th>highlight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>0</td>
      <td>0.983439</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>1</td>
      <td>0.983822</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>2</td>
      <td>0.984404</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>3</td>
      <td>0.985124</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>4</td>
      <td>0.985631</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>133</th>
      <td>UshERStartingTree_Trees</td>
      <td>26</td>
      <td>0.999844</td>
      <td>0</td>
    </tr>
    <tr>
      <th>134</th>
      <td>UshERStartingTree_Trees</td>
      <td>27</td>
      <td>0.999850</td>
      <td>0</td>
    </tr>
    <tr>
      <th>135</th>
      <td>UshERStartingTree_Trees</td>
      <td>28</td>
      <td>0.999976</td>
      <td>0</td>
    </tr>
    <tr>
      <th>136</th>
      <td>UshERStartingTree_Trees</td>
      <td>29</td>
      <td>1.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>137</th>
      <td>TrueTreeSimulations</td>
      <td>0</td>
      <td>0.706890</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>138 rows × 4 columns</p>
</div>




<div class="highlight"><pre><span></span><code><span class="n">collection_maple</span><span class="o">.</span><span class="n">plot_2D</span><span class="p">(</span><span class="s1">&#39;pcoa&#39;</span><span class="p">,</span> <span class="n">plot_meta</span> <span class="o">=</span> <span class="s1">&#39;LK&#39;</span><span class="p">,</span> <span class="n">same_scale</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">select</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">static</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<h4> Hard (not really) example:</h4>
we want to highight the true tree, and the last tree of each set.
In order to perform this task, we can exploit an additional tool: the `set_collection.data`.
This object contains some useful information regarding the structure of each set composing the collection. In particular, we may be interested in the `n_trees` variable which can be used to assess the size of each set!


<div class="highlight"><pre><span></span><code><span class="c1"># this is the object --&gt; collection_maple.data # Note that this is a nested dictionary</span>
<span class="k">for</span> <span class="n">Tset</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">collection_maple</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Tset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;has </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;n_trees&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> trees&quot;</span><span class="p">)</span>
</code></pre></div>

    IQtreeStartingTree_Trees has 29 trees
    MapleStartingTree_Trees has 5 trees
    ParsimonyRAxMLStartingTree_GTRmodel_Trees has 47 trees
    RAxMLNGStartingTree_Trees has 26 trees
    UshERStartingTree_Trees has 30 trees
    TrueTreeSimulations has 1 trees



<div class="highlight"><pre><span></span><code><span class="n">highlight_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">collection_maple</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">last_tree</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">Tset</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">collection_maple</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">last_tree</span> <span class="o">+=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;n_trees&quot;</span><span class="p">]</span>
    <span class="n">highlight_mask</span><span class="p">[</span><span class="n">last_tree</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">collection_maple</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;highlight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">highlight_mask</span>
<span class="n">collection_maple</span><span class="o">.</span><span class="n">metadata</span>
</code></pre></div>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SET-ID</th>
      <th>STEP</th>
      <th>LK</th>
      <th>highlight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>0</td>
      <td>0.983439</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>1</td>
      <td>0.983822</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>2</td>
      <td>0.984404</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>3</td>
      <td>0.985124</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IQtreeStartingTree_Trees</td>
      <td>4</td>
      <td>0.985631</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>133</th>
      <td>UshERStartingTree_Trees</td>
      <td>26</td>
      <td>0.999844</td>
      <td>0</td>
    </tr>
    <tr>
      <th>134</th>
      <td>UshERStartingTree_Trees</td>
      <td>27</td>
      <td>0.999850</td>
      <td>0</td>
    </tr>
    <tr>
      <th>135</th>
      <td>UshERStartingTree_Trees</td>
      <td>28</td>
      <td>0.999976</td>
      <td>0</td>
    </tr>
    <tr>
      <th>136</th>
      <td>UshERStartingTree_Trees</td>
      <td>29</td>
      <td>1.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>137</th>
      <td>TrueTreeSimulations</td>
      <td>0</td>
      <td>0.706890</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>138 rows × 4 columns</p>
</div>




<div class="highlight"><pre><span></span><code><span class="n">collection_maple</span><span class="o">.</span><span class="n">plot_2D</span><span class="p">(</span><span class="s1">&#39;pcoa&#39;</span><span class="p">,</span> <span class="n">plot_meta</span> <span class="o">=</span> <span class="s1">&#39;LK&#39;</span><span class="p">,</span> <span class="n">same_scale</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">select</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div>


</p></section><h1 class='nav-section-title-end'>Ended: Tutorials</h1></div>






              </article>
            </div>


        </div>

      </main>

        <footer class="md-footer">

  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">

    <div class="md-copyright__highlight">
      Made by Andrea Rubbi
    </div>


    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>

</div>

        <div class="md-social">








    <a href="https://www.linkedin.com/in/andrea-rubbi-9a06021a1/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>

</div>

    </div>
  </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>

    <script id="__config" type="application/json">{"base": "/project/pear-ebi/0.1.1.10/", "features": [], "search": "assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>


      <script src="assets/javascripts/bundle.2a6f1dda.min.js"></script>

        <script src="js/print-site.js"></script>

        <script src="js/timeago.min.js"></script>

        <script src="js/timeago_mkdocs_material.js"></script>

        <script src="javascripts/config.js"></script>

        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


  </body>
</html>

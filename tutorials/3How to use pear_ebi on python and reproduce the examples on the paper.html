 <!-- This adds support for mkdocs-git-authors-plugin to mkdocs-material theme --> <!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://pypi.org/project/pear-ebi/0.1.1.10/tutorials/3How%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper.html><link rel=prev href=2Advanced%20use%20of%20pear_ebi.html><link rel=icon href=https://github.com/AndreaRubbi/Pear-EBI/raw/pear_ebi/logos/LOGO_PEAR.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.13"><title>3. How to use Pear on python - PEAR-EBI</title><link rel=stylesheet href=../assets/stylesheets/main.ffa9267a.min.css><link rel=stylesheet href=../assets/stylesheets/palette.a0c5b2b5.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/print-site-enum-headings1.css><link rel=stylesheet href=../css/print-site-enum-headings2.css><link rel=stylesheet href=../css/print-site-enum-headings3.css><link rel=stylesheet href=../css/print-site-enum-headings4.css><link rel=stylesheet href=../css/print-site-enum-headings5.css><link rel=stylesheet href=../css/print-site-enum-headings6.css><link rel=stylesheet href=../css/print-site.css><link rel=stylesheet href=../css/print-site-material.css><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../assets/_mkdocstrings.css><link rel=stylesheet href=../docs_assets/stylesheets/pdf-export.css><link rel=stylesheet href=../css/ansi-colours.css><link rel=stylesheet href=../css/pandas-dataframe.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=preference data-md-color-primary=green data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#3-how-to-use-pear-on-python class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../index.html title=PEAR-EBI class="md-header__button md-logo" aria-label=PEAR-EBI data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> PEAR-EBI </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 3. How to use Pear on python </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/AndreaRubbi/Pear-EBI title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> PEAR-EBI </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../index.html title=PEAR-EBI class="md-nav__button md-logo" aria-label=PEAR-EBI data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg> </a> PEAR-EBI </label> <div class=md-nav__source> <a href=https://github.com/AndreaRubbi/Pear-EBI title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> PEAR-EBI </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../index.html class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> Modules <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Modules </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../modules/gendoc.html class=md-nav__link> Gendoc </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> Pear ebi <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Pear ebi </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../modules/pear_ebi/tree_emb_parser.html class=md-nav__link> Tree emb parser </a> </li> <li class=md-nav__item> <a href=../modules/pear_ebi/tree_set.html class=md-nav__link> Tree set </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3> <label class=md-nav__link for=__nav_2_2_3 id=__nav_2_2_3_label tabindex=0> Calculate distances <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3> <span class="md-nav__icon md-icon"></span> Calculate distances </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../modules/pear_ebi/calculate_distances/hashrf.html class=md-nav__link> Hashrf </a> </li> <li class=md-nav__item> <a href=../modules/pear_ebi/calculate_distances/maple_RF.html class=md-nav__link> maple RF </a> </li> <li class=md-nav__item> <a href=../modules/pear_ebi/calculate_distances/tqdist.html class=md-nav__link> Tqdist </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_4> <label class=md-nav__link for=__nav_2_2_4 id=__nav_2_2_4_label tabindex=0> Embeddings <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_4> <span class="md-nav__icon md-icon"></span> Embeddings </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../modules/pear_ebi/embeddings/Isomap_e.html class=md-nav__link> Isomap e </a> </li> <li class=md-nav__item> <a href=../modules/pear_ebi/embeddings/LLE_e.html class=md-nav__link> LLE e </a> </li> <li class=md-nav__item> <a href=../modules/pear_ebi/embeddings/PCoA_e.html class=md-nav__link> PCoA e </a> </li> <li class=md-nav__item> <a href=../modules/pear_ebi/embeddings/emb_quality.html class=md-nav__link> Emb quality </a> </li> <li class=md-nav__item> <a href=../modules/pear_ebi/embeddings/tSNE_e.html class=md-nav__link> tSNE e </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_4_6> <label class=md-nav__link for=__nav_2_2_4_6 id=__nav_2_2_4_6_label tabindex=0> Graph <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_4_6> <span class="md-nav__icon md-icon"></span> Graph </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../modules/pear_ebi/embeddings/graph/graph.html class=md-nav__link> Graph </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_5> <label class=md-nav__link for=__nav_2_2_5 id=__nav_2_2_5_label tabindex=0> Interactive mode <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_5> <span class="md-nav__icon md-icon"></span> Interactive mode </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../modules/pear_ebi/interactive_mode/interactive.html class=md-nav__link> Interactive </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_6> <label class=md-nav__link for=__nav_2_2_6 id=__nav_2_2_6_label tabindex=0> Subsample <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_6> <span class="md-nav__icon md-icon"></span> Subsample </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../modules/pear_ebi/subsample/subsample.html class=md-nav__link> Subsample </a> </li> <li class=md-nav__item> <a href=../modules/pear_ebi/subsample/subsample_multiprocess.html class=md-nav__link> Subsample multiprocess </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> Test <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Test </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../modules/test/test.html class=md-nav__link> Test </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> Tutorials <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=1How_to_use_pear_ebi.html class=md-nav__link> 1. How to use Pear </a> </li> <li class=md-nav__item> <a href=2Advanced%20use%20of%20pear_ebi.html class=md-nav__link> 2. Advanced uses of Pear </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 3. How to use Pear on python <span class="md-nav__icon md-icon"></span> </label> <a href=3How%20to%20use%20pear_ebi%20on%20python%20and%20reproduce%20the%20examples%20on%20the%20paper.html class="md-nav__link md-nav__link--active"> 3. How to use Pear on python </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#examples class=md-nav__link> Examples </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#examples class=md-nav__link> Examples </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=3-how-to-use-pear-on-python>3. How to use Pear on python<a class=headerlink href=#3-how-to-use-pear-on-python title="Permanent link">&para;</a></h1> <h1></h1> <p>Here we report the code used to generate the examples in the manuscript, providing a general outline of the use of the python library</p> <p><code>tree_set</code> is the main module of <code>pear_ebi</code> - it contains both the <font color=blue><b>tree_set</b></font> and the <font color=red><b>set_collection</b></font> objects.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>pear_ebi</span> <span class=kn>import</span> <span class=n>tree_set</span>
<span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
<span class=kn>import</span> <span class=nn>time</span>
<span class=kn>import</span> <span class=nn>os</span>
</code></pre></div> <h2 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">&para;</a></h2> <p>Here we do not delve into the specifics or the rationale of the experiments - for that we redirect you to the related manuscript - but rather focus on the use of the library to analyze sets of trees in different settings.</p> <hr> <h1 id=beast>BEAST<a class=headerlink href=#beast title="Permanent link">&para;</a></h1> <h3 id=bayesan-markow-chain-monte-carlo><font color=purple> Bayesan - Markow Chain Monte Carlo </font><a class=headerlink href=#bayesan-markow-chain-monte-carlo title="Permanent link">&para;</a></h3> <p>This is a relatively simple example: we have a few files containing trees in Newick format, where each set of trees is produced by a program that produced them sequentially. We want to represent the distribution of these trees in order to analyze the single trajectories and to compare the different trjectories coming from different runs. <br> With this idea in mind, we simply compute the square distance matrix using the <code>Robinson Foulds</code> metric, which generally represents the relations between trees in an effective way, using the most efficient algorithm: <code>hashrf</code>.<br> We then compute and plot the <code>PCoA</code> embeddings in 2 and 3 dimensions. </p> <h4 id=step-1-load-trees>Step 1: load trees<a class=headerlink href=#step-1-load-trees title="Permanent link">&para;</a></h4> <p><font color=blue><b>tree_set</b></font> is meant to store and manage the analysis of a single set of trees stored in the same file. These trees have to be in the (standard) Newick format.<br> <code>tree_set = tree_set.tree_set(file, output_file=None, distance_matrix=None, metadata=None)</code> <br>The first argument indicates the file where the trees are stored. <code>output_file</code> can be empty and may be used to indicate a specific name and path for the output distance matrix. <code>distance_matrix</code> can be used to indicate a precomputed distance matrix in the <code>.csv</code> format. <code>metadata</code> may be used to indicate a <code>.csv</code> file with additional information relative to the trees. It must be of the same dimensionality of the set of trees, hence <span class=arithmatex>\(size = (|trees|, |meta\)</span>-<span class=arithmatex>\(variables|)\)</span>. </p> <hr> <p><font color=red><b>set_collection</b></font> performs the same tasks of <font color=blue><b>tree_set</b></font>, but stores multiple set of trees. <b>NB:</b> for each file, a set of trees is defined within the set collection. In practice, a <font color=red><b>set_collection</b></font> is a collection of different <font color=blue><b>tree_set</b></font>, each one containing a set of trees coming from a different file. It should not come as a surprise, then, that the input <code>collection=list()</code>, potentially empty (one may initialize an empty collection), is a list of files containing trees in the Newick format. <code>set_collection=tree_set.set_collection(collection=list(), file="Set_collection_", output_file=None, distance_matrix=None, metadata=None,)</code> <br><code>file</code> may be used to indicate an alternative name for the file containing the collection information. This file will be used by pear to store information relative to the sets of trees. <code>output_file</code> may be used to indicate a specific name for the distance matrix file. <br><code>distance_matrix</code> can be used to indicate a precomputed distance matrix in the <code>.csv</code> format. <code>metadata</code> may be used to indicate a <code>.csv</code> file with additional information relative to the trees. It must be of the same dimensionality of the set of trees, hence <span class=arithmatex>\(size = (|trees|, |meta\)</span>-<span class=arithmatex>\(variables|)\)</span>.</p> <div class=highlight><pre><span></span><code><span class=n>beast_dir</span> <span class=o>=</span> <span class=s1>&#39;../beast_trees&#39;</span>
<span class=n>beast_runs</span> <span class=o>=</span> <span class=p>[</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>beast_dir</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;beast_run</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>.trees&quot;</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>9</span><span class=p>)]</span> <span class=o>+</span> <span class=p>[</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>beast_dir</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;beast_long.trees&quot;</span><span class=p>)]</span>
<span class=n>beast_collection</span> <span class=o>=</span> <span class=n>tree_set</span><span class=o>.</span><span class=n>set_collection</span><span class=p>(</span><span class=n>beast_runs</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>beast_collection</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>─────────────────────────────            
 Tree set collection containing 9009 trees;            
 File: Set_collection_d67b3fc3-bac4-4e5f-934c-0c8dc668f012;
 Distance matrix: not computed.                
───────────────────────────── 
beast_run1; Containing 1001 trees. 
beast_run2; Containing 1001 trees. 
beast_run3; Containing 1001 trees. 
beast_run4; Containing 1001 trees. 
beast_run5; Containing 1001 trees. 
beast_run6; Containing 1001 trees. 
beast_run7; Containing 1001 trees. 
beast_run8; Containing 1001 trees. 
beast_long; Containing 1001 trees.
</code></pre></div> <h4 id=step-2-compute-distances>Step 2: compute distances<a class=headerlink href=#step-2-compute-distances title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><span class=n>beast_collection</span><span class=o>.</span><span class=n>calculate_distances</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s2>&quot;hashrf_RF&quot;</span><span class=p>)</span> 
<span class=c1># where method can be chosen among hashrf_RF,</span>
<span class=c1># hashrf_wRF, smart_RF, tqdist_quartet, tqdist_triplet</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>Output()
</code></pre></div> <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre> <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">hashrf_RF | Done!</span>
</pre> <h4 id=step-3-compute-embeddings>Step 3: compute embeddings<a class=headerlink href=#step-3-compute-embeddings title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><span class=n>beast_collection</span><span class=o>.</span><span class=n>embed</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s2>&quot;pcoa&quot;</span><span class=p>,</span> <span class=n>dimensions</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>quality</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=c1># where method can be chosen among pcoa, tsne, isomap, lle</span>
<span class=c1># pro tip: if the distance matrix has not been computed prior to calling this function,</span>
<span class=c1># it will automatically be computed using hashrf_RF</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>Output()
</code></pre></div> <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre> <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">pcoa | Done!</span>
</pre> <h4 id=step-4-plot-embeddings>Step 4: Plot embeddings<a class=headerlink href=#step-4-plot-embeddings title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><span class=n>beast_collection</span><span class=o>.</span><span class=n>plot_2D</span><span class=p>(</span>
        <span class=n>method</span><span class=o>=</span><span class=s1>&#39;pcoa&#39;</span><span class=p>,</span> <span class=c1># method used for the embedding - if not previously computed, it will be computed when calling this function </span>
        <span class=n>save</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=c1># save the plot in a pdf format? The .html will be saved anyway!</span>
        <span class=n>name_plot</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=c1># specific name for the plot</span>
        <span class=n>static</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=c1># create a static element rather than a dynamic widget</span>
        <span class=n>plot_meta</span><span class=o>=</span><span class=s2>&quot;SET-ID&quot;</span><span class=p>,</span> <span class=c1># meta-variable used to colour the points (trees)</span>
        <span class=n>plot_set</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=c1># select specific set of sets of trees in the collection for the plot</span>
        <span class=n>select</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=c1># create widgets to hide/display tree_sets in the graph</span>
        <span class=n>same_scale</span><span class=o>=</span><span class=kc>False</span><span class=p>,)</span> <span class=c1># use the same colorscale for each tree_set (useful when the same metric is compared among sets)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>beast_collection</span><span class=o>.</span><span class=n>plot_3D</span><span class=p>(</span>
        <span class=n>method</span><span class=o>=</span><span class=s1>&#39;pcoa&#39;</span><span class=p>,</span>
        <span class=n>save</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
        <span class=n>name_plot</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>static</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
        <span class=n>plot_meta</span><span class=o>=</span><span class=s2>&quot;SET-ID&quot;</span><span class=p>,</span>
        <span class=n>plot_set</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>select</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
        <span class=n>same_scale</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
        <span class=n>z_axis</span><span class=o>=</span><span class=kc>None</span><span class=p>,)</span> <span class=c1># substitute the 3rd axis (Z-axis/3rd PCoA) with a meta-variable of choice</span>
</code></pre></div> <hr> <h1 id=raxml>RAxML<a class=headerlink href=#raxml title="Permanent link">&para;</a></h1> <h3 id=bootstrap-analysis><font color=purple> Bootstrap Analysis </font><a class=headerlink href=#bootstrap-analysis title="Permanent link">&para;</a></h3> <p>We do not delve into the biological interpretation of this specific example, as we discussed that in our manuscript. <br> Instead, we point your attention to some specific features of pear's interactive representations: <ul> <li> First: you can directly plot the <code>PCoA</code> embedding of the Robinson Foulds distances computed with <code>hashrf</code> without explicitly going through these steps. In fact, running a plotting function bypasses steps 2 and 3, performing them "under the hood"; <li> In the 2D representation:<ul> <li> From the dropdown menu, one can choose the meta-vatiable used to color the points in the graphs; <li> The red button "Save plot as pdf" saves the plot in a <code>.pdf</code> file; <li> The <span class=arithmatex>\(#show <code>name of the tree set</code>\)</span> buttons allow showing and hiding specific sets of trees; <li> One may choose between the scatter representation or a contour plot; <li> While visualizing a contour plot, one may choose to hide or show the points (trees) with the light blue button "Show points on a Contour plot"; <li> One can choose between visualizing only the points or also the connections between them (indicating the progress through an hypotetical sequential order); <li> One can use the native tools of the plot so zoom in to focus on a specific area of the graph; <li> If one wants to focus their attention on specific sets of trees, they just have to click them: this will highlight the selected set and make the other sets transparent. One may continue and highlight on other sets by simply clicking on them. In order to go back to the original representation, one just needs to click on one of the previously highlighted sets for a second time. </ul> <br> <li> In the 3D representation:<ul> <li> Same features of the 2D representation. However, there is no contour plot in this case. <div class=highlight><pre><span></span><code><span class=n>input_dir</span> <span class=o>=</span> <span class=s1>&#39;../bootstrap_mammals/&#39;</span>
<span class=n>files</span> <span class=o>=</span> <span class=p>([</span><span class=sa>f</span><span class=s1>&#39;bootstrap_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>6086</span><span class=p>,</span> <span class=mi>5261</span><span class=p>,</span> <span class=mi>5092</span><span class=p>,</span> <span class=mi>281</span><span class=p>,</span> <span class=mi>11289</span><span class=p>,</span> <span class=mi>10409</span><span class=p>]]</span> <span class=o>+</span> 
    <span class=p>[</span><span class=sa>f</span><span class=s1>&#39;bestTree_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>6086</span><span class=p>,</span> <span class=mi>5261</span><span class=p>,</span> <span class=mi>5092</span><span class=p>,</span> <span class=mi>281</span><span class=p>,</span> <span class=mi>11289</span><span class=p>,</span> <span class=mi>10409</span><span class=p>]])</span>
<span class=n>collection</span> <span class=o>=</span> <span class=n>tree_set</span><span class=o>.</span><span class=n>set_collection</span><span class=p>([</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>input_dir</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>files</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=n>collection</span><span class=p>)</span>
</code></pre></div> ───────────────────────────── Tree set collection containing 3656 trees; File: Set_collection_4cbb9500-1e98-40cd-84ec-a9c8bd511698; Distance matrix: not computed. ───────────────────────────── bootstrap_6086; Containing 500 trees. bootstrap_5261; Containing 600 trees. bootstrap_5092; Containing 800 trees. bootstrap_281; Containing 600 trees. bootstrap_11289; Containing 600 trees. bootstrap_10409; Containing 550 trees. bestTree_6086; Containing 1 trees. bestTree_5261; Containing 1 trees. bestTree_5092; Containing 1 trees. bestTree_281; Containing 1 trees. bestTree_11289; Containing 1 trees. bestTree_10409; Containing 1 trees. <div class=highlight><pre><span></span><code><span class=n>collection</span><span class=o>.</span><span class=n>plot_2D</span><span class=p>(</span><span class=s1>&#39;pcoa&#39;</span><span class=p>,</span> <span class=n>select</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>collection</span><span class=o>.</span><span class=n>plot_3D</span><span class=p>(</span><span class=s1>&#39;pcoa&#39;</span><span class=p>,</span> <span class=n>select</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span>
</code></pre></div> <h1> MAPLE </h1> <h3> <font color=purple> Maximum Likelihood Search </font></h3> In this specific example, we focus the readers' attention on the possibility of specifying a metadata file to add meta-variable and use them to color the points in the plots or to replace the $Z_{axis}$ in the 3D plot.<br> In the cell below we specify a list of files containing trees and a list of files containing the likelihood of each tree. <div class=highlight><pre><span></span><code><span class=n>maple_tree</span> <span class=o>=</span> <span class=p>[</span>
    <span class=s2>&quot;IQtreeStartingTree_Trees&quot;</span><span class=p>,</span>
    <span class=s2>&quot;MapleStartingTree_Trees&quot;</span><span class=p>,</span>
    <span class=s2>&quot;ParsimonyRAxMLStartingTree_GTRmodel_Trees&quot;</span><span class=p>,</span>
    <span class=s2>&quot;RAxMLNGStartingTree_Trees&quot;</span><span class=p>,</span>
    <span class=s2>&quot;UshERStartingTree_Trees&quot;</span><span class=p>,</span>
    <span class=s2>&quot;TrueTreeSimulations&quot;</span><span class=p>,</span>
    <span class=p>]</span>

<span class=n>maple_LK</span> <span class=o>=</span> <span class=p>[</span>
    <span class=s2>&quot;IQtreeStartingTree_LK&quot;</span><span class=p>,</span>
    <span class=s2>&quot;MapleStartingTree_LK&quot;</span><span class=p>,</span>
    <span class=s2>&quot;ParsimonyRAxMLStartingTree_GTRmodel_LK&quot;</span><span class=p>,</span>
    <span class=s2>&quot;RAxMLNGStartingTree_LK&quot;</span><span class=p>,</span>
    <span class=s2>&quot;UshERStartingTree_LK&quot;</span><span class=p>,</span>
<span class=p>]</span>

<span class=n>maple_dir</span> <span class=o>=</span> <span class=s1>&#39;../MAPLE_res/&#39;</span>
</code></pre></div> In the cell below we check that "DisMat_Maple.csv", the precomputed distance matrix, is present in the folder. We precomputed the distances as the `smart_RF` algorithm, which computes a modified version of the Robinson Foulds metric, takes much longer than `hashrf_RF`. <div class=highlight><pre><span></span><code><span class=n>set_list</span> <span class=o>=</span> <span class=p>[</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>maple_dir</span><span class=p>,</span> <span class=n>tree</span><span class=p>)</span> <span class=k>for</span> <span class=n>tree</span> <span class=ow>in</span> <span class=n>maple_tree</span><span class=p>]</span>
<span class=k>try</span><span class=p>:</span><span class=n>collection_maple</span> <span class=o>=</span> <span class=n>tree_set</span><span class=o>.</span><span class=n>set_collection</span><span class=p>(</span><span class=n>set_list</span><span class=p>,</span> <span class=n>distance_matrix</span> <span class=o>=</span> <span class=s2>&quot;DistMat_Maple.csv&quot;</span><span class=p>)</span>
<span class=k>except</span><span class=p>:</span><span class=n>collection_maple</span> <span class=o>=</span> <span class=n>tree_set</span><span class=o>.</span><span class=n>set_collection</span><span class=p>(</span><span class=n>set_list</span><span class=p>)</span>
<span class=k>finally</span><span class=p>:</span><span class=nb>print</span><span class=p>(</span><span class=n>collection_maple</span><span class=p>)</span>
</code></pre></div> ───────────────────────────── Tree set collection containing 138 trees; File: Set_collection_17e30756-0754-4fbb-9ed7-cb862716a7f8; Distance matrix: computed. ───────────────────────────── IQtreeStartingTree_Trees; Containing 29 trees. MapleStartingTree_Trees; Containing 5 trees. ParsimonyRAxMLStartingTree_GTRmodel_Trees; Containing 47 trees. RAxMLNGStartingTree_Trees; Containing 26 trees. UshERStartingTree_Trees; Containing 30 trees. TrueTreeSimulations; Containing 1 trees. This is how we extracted the information from multiple files - one may simply skip this step as we then saved the information in the "Likelihoods.csv" file. <div class=highlight><pre><span></span><code><span class=n>LKs</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
<span class=k>for</span> <span class=n>lk_file</span> <span class=ow>in</span> <span class=n>maple_LK</span><span class=p>:</span>
    <span class=n>file</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>maple_dir</span><span class=p>,</span> <span class=n>lk_file</span><span class=p>)</span>
    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
        <span class=n>LKs</span><span class=p>[</span><span class=n>lk_file</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>())</span>
        <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>

<span class=n>LK</span> <span class=o>=</span> <span class=nb>list</span><span class=p>()</span>
<span class=k>for</span> <span class=n>lk</span> <span class=ow>in</span> <span class=n>LKs</span><span class=o>.</span><span class=n>values</span><span class=p>():</span> <span class=n>LK</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>lk</span><span class=p>)</span>

<span class=n>LK</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>tree</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=k>for</span> <span class=n>tree</span> <span class=ow>in</span> <span class=n>LK</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>)</span>
<span class=n>LK</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>LK</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=o>-</span><span class=mi>257513</span><span class=p>])],</span> <span class=n>axis</span> <span class=o>=</span> <span class=mi>0</span><span class=p>)</span>
<span class=n>LK</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>interp</span><span class=p>(</span><span class=n>LK</span><span class=p>,</span> <span class=p>(</span><span class=n>LK</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>LK</span><span class=o>.</span><span class=n>max</span><span class=p>()),</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=o>+</span><span class=mi>1</span><span class=p>))</span> <span class=c1># scale LKs between 0 and 1</span>

<span class=n>df_LK</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;LK&#39;</span><span class=p>:</span><span class=n>LK</span><span class=p>})</span>
<span class=n>df_LK</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s2>&quot;Likelihoods.csv&quot;</span><span class=p>)</span>
<span class=n>df_LK</span>
</code></pre></div> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class=dataframe> <thead> <tr style="text-align: right;"> <th></th> <th>LK</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>0.983439</td> </tr> <tr> <th>1</th> <td>0.983822</td> </tr> <tr> <th>2</th> <td>0.984404</td> </tr> <tr> <th>3</th> <td>0.985124</td> </tr> <tr> <th>4</th> <td>0.985631</td> </tr> <tr> <th>...</th> <td>...</td> </tr> <tr> <th>133</th> <td>0.999844</td> </tr> <tr> <th>134</th> <td>0.999850</td> </tr> <tr> <th>135</th> <td>0.999976</td> </tr> <tr> <th>136</th> <td>1.000000</td> </tr> <tr> <th>137</th> <td>0.706890</td> </tr> </tbody> </table> <p>138 rows × 1 columns</p> </div> There are two ways to introduce new variables in a <font color=red><b>set_collection</b></font>'s or <font color=blue><b>tree_set</b></font>'s metadata: <div class=highlight><pre><span></span><code><span class=c1># Method 1:</span>
<span class=c1># Given that metadata is a pandas dataframe, </span>
<span class=c1># one may simply add columns to it!</span>
<span class=n>df_LK</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&quot;Likelihoods.csv&quot;</span><span class=p>)</span>
<span class=n>collection_maple</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;LK&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_LK</span><span class=p>[</span><span class=s1>&#39;LK&#39;</span><span class=p>]</span>
<span class=n>collection_maple</span><span class=o>.</span><span class=n>metadata</span>
</code></pre></div> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class=dataframe> <thead> <tr style="text-align: right;"> <th></th> <th>SET-ID</th> <th>STEP</th> <th>LK</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>IQtreeStartingTree_Trees</td> <td>0</td> <td>0.983439</td> </tr> <tr> <th>1</th> <td>IQtreeStartingTree_Trees</td> <td>1</td> <td>0.983822</td> </tr> <tr> <th>2</th> <td>IQtreeStartingTree_Trees</td> <td>2</td> <td>0.984404</td> </tr> <tr> <th>3</th> <td>IQtreeStartingTree_Trees</td> <td>3</td> <td>0.985124</td> </tr> <tr> <th>4</th> <td>IQtreeStartingTree_Trees</td> <td>4</td> <td>0.985631</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>133</th> <td>UshERStartingTree_Trees</td> <td>26</td> <td>0.999844</td> </tr> <tr> <th>134</th> <td>UshERStartingTree_Trees</td> <td>27</td> <td>0.999850</td> </tr> <tr> <th>135</th> <td>UshERStartingTree_Trees</td> <td>28</td> <td>0.999976</td> </tr> <tr> <th>136</th> <td>UshERStartingTree_Trees</td> <td>29</td> <td>1.000000</td> </tr> <tr> <th>137</th> <td>TrueTreeSimulations</td> <td>0</td> <td>0.706890</td> </tr> </tbody> </table> <p>138 rows × 3 columns</p> </div> <div class=highlight><pre><span></span><code><span class=c1># Method 2:</span>
<span class=c1># One may specify a file with additional </span>
<span class=c1># metadata when the object is created</span>
<span class=n>collection_maple</span> <span class=o>=</span> <span class=n>tree_set</span><span class=o>.</span><span class=n>set_collection</span><span class=p>(</span><span class=n>set_list</span><span class=p>,</span> <span class=n>distance_matrix</span> <span class=o>=</span> <span class=s2>&quot;DistMat_Maple.csv&quot;</span><span class=p>,</span> <span class=n>metadata</span><span class=o>=</span><span class=s2>&quot;Likelihoods.csv&quot;</span><span class=p>)</span>
<span class=n>collection_maple</span><span class=o>.</span><span class=n>metadata</span>
</code></pre></div> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class=dataframe> <thead> <tr style="text-align: right;"> <th></th> <th>SET-ID</th> <th>STEP</th> <th>LK</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>IQtreeStartingTree_Trees</td> <td>0</td> <td>0.983439</td> </tr> <tr> <th>1</th> <td>IQtreeStartingTree_Trees</td> <td>1</td> <td>0.983822</td> </tr> <tr> <th>2</th> <td>IQtreeStartingTree_Trees</td> <td>2</td> <td>0.984404</td> </tr> <tr> <th>3</th> <td>IQtreeStartingTree_Trees</td> <td>3</td> <td>0.985124</td> </tr> <tr> <th>4</th> <td>IQtreeStartingTree_Trees</td> <td>4</td> <td>0.985631</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>133</th> <td>UshERStartingTree_Trees</td> <td>26</td> <td>0.999844</td> </tr> <tr> <th>134</th> <td>UshERStartingTree_Trees</td> <td>27</td> <td>0.999850</td> </tr> <tr> <th>135</th> <td>UshERStartingTree_Trees</td> <td>28</td> <td>0.999976</td> </tr> <tr> <th>136</th> <td>UshERStartingTree_Trees</td> <td>29</td> <td>1.000000</td> </tr> <tr> <th>137</th> <td>TrueTreeSimulations</td> <td>0</td> <td>0.706890</td> </tr> </tbody> </table> <p>138 rows × 3 columns</p> </div> If, for any reason, the "DisMat_Maple.csv" is not present in the folder, we need to compute the distance matrix. We chose to upload the precomputed distance matrix as the `smart_RF` method takes much longer to compute than `hashrf_RF`, and we wanted this notebook to run smoothly and rapidly. <div class=highlight><pre><span></span><code><span class=k>if</span> <span class=n>collection_maple</span><span class=o>.</span><span class=n>distance_matrix</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>collection_maple</span><span class=o>.</span><span class=n>calculate_distances</span><span class=p>(</span><span class=s1>&#39;days_RF&#39;</span><span class=p>)</span>
    <span class=n>np</span><span class=o>.</span><span class=n>savetxt</span><span class=p>(</span><span class=s2>&quot;DistMat_Maple.csv&quot;</span><span class=p>,</span> <span class=n>collection_maple</span><span class=o>.</span><span class=n>distance_matrix</span><span class=p>,</span> <span class=n>delimiter</span><span class=o>=</span><span class=s2>&quot;,&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span>
<span class=n>collection_maple</span><span class=o>.</span><span class=n>distance_matrix</span><span class=o>.</span><span class=n>shape</span>
</code></pre></div> (138, 138) We colour the trees based on their likelihood in the 2D plot, while we replace the $Z_{axis}$ with the likelihood in the 3D plot. <br> `same_scale` makes sure that points with the same value have the same colour in the graphs. <div class=highlight><pre><span></span><code><span class=n>collection_maple</span><span class=o>.</span><span class=n>plot_3D</span><span class=p>(</span><span class=s1>&#39;pcoa&#39;</span><span class=p>,</span> <span class=n>plot_meta</span> <span class=o>=</span> <span class=s1>&#39;LK&#39;</span><span class=p>,</span> <span class=n>same_scale</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span> <span class=n>select</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>collection_maple</span><span class=o>.</span><span class=n>plot_3D</span><span class=p>(</span><span class=s1>&#39;pcoa&#39;</span><span class=p>,</span> <span class=n>plot_meta</span> <span class=o>=</span> <span class=s1>&#39;LK&#39;</span><span class=p>,</span> <span class=n>same_scale</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span> <span class=n>select</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span> <span class=n>z_axis</span> <span class=o>=</span> <span class=s1>&#39;LK&#39;</span><span class=p>)</span>
</code></pre></div> What if I wanted to make one of these trees to "pop out"? Well, we can add a coulumn called `"highlight"` that will automatically be read by the plotting function to "highloght" the points specified. The columns has to be binary (0s and 1s), where the 1s indicate that a tree should be highlighted. It is crucial here to know the order and size of the sets, as the column is shared by the whole collection. <b>Note that</b>: the vector `"highlight"` <b>must be integer (dtype = int)!</b>. <h4> Easy example:</h4> we want to highight the true tree, which is the last in the collection. <div class=highlight><pre><span></span><code><span class=n>highlight_mask</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>collection_maple</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span> <span class=c1># vector of 0s with size = n_trees</span>
<span class=n>highlight_mask</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span> <span class=c1># last element set to 1</span>
<span class=n>collection_maple</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;highlight&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>highlight_mask</span>
<span class=n>collection_maple</span><span class=o>.</span><span class=n>metadata</span>
</code></pre></div> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class=dataframe> <thead> <tr style="text-align: right;"> <th></th> <th>SET-ID</th> <th>STEP</th> <th>LK</th> <th>highlight</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>IQtreeStartingTree_Trees</td> <td>0</td> <td>0.983439</td> <td>0</td> </tr> <tr> <th>1</th> <td>IQtreeStartingTree_Trees</td> <td>1</td> <td>0.983822</td> <td>0</td> </tr> <tr> <th>2</th> <td>IQtreeStartingTree_Trees</td> <td>2</td> <td>0.984404</td> <td>0</td> </tr> <tr> <th>3</th> <td>IQtreeStartingTree_Trees</td> <td>3</td> <td>0.985124</td> <td>0</td> </tr> <tr> <th>4</th> <td>IQtreeStartingTree_Trees</td> <td>4</td> <td>0.985631</td> <td>0</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>133</th> <td>UshERStartingTree_Trees</td> <td>26</td> <td>0.999844</td> <td>0</td> </tr> <tr> <th>134</th> <td>UshERStartingTree_Trees</td> <td>27</td> <td>0.999850</td> <td>0</td> </tr> <tr> <th>135</th> <td>UshERStartingTree_Trees</td> <td>28</td> <td>0.999976</td> <td>0</td> </tr> <tr> <th>136</th> <td>UshERStartingTree_Trees</td> <td>29</td> <td>1.000000</td> <td>0</td> </tr> <tr> <th>137</th> <td>TrueTreeSimulations</td> <td>0</td> <td>0.706890</td> <td>1</td> </tr> </tbody> </table> <p>138 rows × 4 columns</p> </div> <div class=highlight><pre><span></span><code><span class=n>collection_maple</span><span class=o>.</span><span class=n>plot_2D</span><span class=p>(</span><span class=s1>&#39;pcoa&#39;</span><span class=p>,</span> <span class=n>plot_meta</span> <span class=o>=</span> <span class=s1>&#39;LK&#39;</span><span class=p>,</span> <span class=n>same_scale</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span> <span class=n>select</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=n>static</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span>
</code></pre></div> <h4> Hard (not really) example:</h4> we want to highight the true tree, and the last tree of each set. In order to perform this task, we can exploit an additional tool: the `set_collection.data`. This object contains some useful information regarding the structure of each set composing the collection. In particular, we may be interested in the `n_trees` variable which can be used to assess the size of each set! <div class=highlight><pre><span></span><code><span class=c1># this is the object --&gt; collection_maple.data # Note that this is a nested dictionary</span>
<span class=k>for</span> <span class=n>Tset</span><span class=p>,</span> <span class=n>info</span> <span class=ow>in</span> <span class=n>collection_maple</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>Tset</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;has </span><span class=si>{</span><span class=n>info</span><span class=p>[</span><span class=s1>&#39;n_trees&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> trees&quot;</span><span class=p>)</span>
</code></pre></div> IQtreeStartingTree_Trees has 29 trees MapleStartingTree_Trees has 5 trees ParsimonyRAxMLStartingTree_GTRmodel_Trees has 47 trees RAxMLNGStartingTree_Trees has 26 trees UshERStartingTree_Trees has 30 trees TrueTreeSimulations has 1 trees <div class=highlight><pre><span></span><code><span class=n>highlight_mask</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>collection_maple</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
<span class=n>last_tree</span> <span class=o>=</span> <span class=mi>0</span>
<span class=k>for</span> <span class=n>Tset</span><span class=p>,</span> <span class=n>info</span> <span class=ow>in</span> <span class=n>collection_maple</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
    <span class=n>last_tree</span> <span class=o>+=</span> <span class=n>info</span><span class=p>[</span><span class=s2>&quot;n_trees&quot;</span><span class=p>]</span>
    <span class=n>highlight_mask</span><span class=p>[</span><span class=n>last_tree</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
<span class=n>collection_maple</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;highlight&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>highlight_mask</span>
<span class=n>collection_maple</span><span class=o>.</span><span class=n>metadata</span>
</code></pre></div> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class=dataframe> <thead> <tr style="text-align: right;"> <th></th> <th>SET-ID</th> <th>STEP</th> <th>LK</th> <th>highlight</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>IQtreeStartingTree_Trees</td> <td>0</td> <td>0.983439</td> <td>0</td> </tr> <tr> <th>1</th> <td>IQtreeStartingTree_Trees</td> <td>1</td> <td>0.983822</td> <td>0</td> </tr> <tr> <th>2</th> <td>IQtreeStartingTree_Trees</td> <td>2</td> <td>0.984404</td> <td>0</td> </tr> <tr> <th>3</th> <td>IQtreeStartingTree_Trees</td> <td>3</td> <td>0.985124</td> <td>0</td> </tr> <tr> <th>4</th> <td>IQtreeStartingTree_Trees</td> <td>4</td> <td>0.985631</td> <td>0</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>133</th> <td>UshERStartingTree_Trees</td> <td>26</td> <td>0.999844</td> <td>0</td> </tr> <tr> <th>134</th> <td>UshERStartingTree_Trees</td> <td>27</td> <td>0.999850</td> <td>0</td> </tr> <tr> <th>135</th> <td>UshERStartingTree_Trees</td> <td>28</td> <td>0.999976</td> <td>0</td> </tr> <tr> <th>136</th> <td>UshERStartingTree_Trees</td> <td>29</td> <td>1.000000</td> <td>1</td> </tr> <tr> <th>137</th> <td>TrueTreeSimulations</td> <td>0</td> <td>0.706890</td> <td>1</td> </tr> </tbody> </table> <p>138 rows × 4 columns</p> </div> <div class=highlight><pre><span></span><code><span class=n>collection_maple</span><span class=o>.</span><span class=n>plot_2D</span><span class=p>(</span><span class=s1>&#39;pcoa&#39;</span><span class=p>,</span> <span class=n>plot_meta</span> <span class=o>=</span> <span class=s1>&#39;LK&#39;</span><span class=p>,</span> <span class=n>same_scale</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span> <span class=n>select</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span>
</code></pre></div> </p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2024-04-29T10:13:55+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-04-29</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Made by Andrea Rubbi </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://www.linkedin.com/in/andrea-rubbi-9a06021a1/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.2a6f1dda.min.js></script> <script src=../js/print-site.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> <script src=../javascripts/config.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>